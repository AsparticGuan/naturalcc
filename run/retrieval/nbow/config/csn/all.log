nohup: 忽略输入
[2021-04-09 22:56:58]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn/all.yml (train.py:302, cli_main())
[2021-04-09 22:56:58]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go', 'java', 'javascript', 'ruby', 'python', 'php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': 1000}} (train.py:304, cli_main())
[2021-04-09 22:56:58]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-09 22:57:02]    INFO >> loaded 89154 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.go.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.java.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.javascript.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.ruby.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.python.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-09 22:57:02]    INFO >> loaded 89154 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.go.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.java.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.javascript.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.ruby.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.python.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-09 22:57:02]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (go): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
    (java): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
    (javascript): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
    (ruby): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
    (python): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
    (php): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-09 22:57:02]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-09 22:57:02]    INFO >> num. model params: 8960896 (num. trained: 8960896) (train.py:227, single_main())
[2021-04-09 22:57:21]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-09 22:57:21]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-09 22:57:21]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-09 22:57:21]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-09 22:57:35]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-09 22:57:35]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-09 22:57:47]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-09 22:57:49]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-09 22:57:51]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-09 22:58:32]    INFO >> epoch 001:    500 / 1881 loss=1.013, mrr=166.131, sample_size=1000, wps=18881.7, ups=18.88, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.021, clip=0.4, train_wall=12, wall=71 (progress_bar.py:262, log())
[2021-04-09 22:59:01]    INFO >> epoch 001:   1000 / 1881 loss=0.997, mrr=367.501, sample_size=1000, wps=17326.2, ups=17.33, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.007, clip=0, train_wall=7, wall=100 (progress_bar.py:262, log())
[2021-04-09 22:59:30]    INFO >> epoch 001:   1501 / 1881 loss=0.985, mrr=513.589, sample_size=1000, wps=17544.1, ups=17.54, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.011, clip=0, train_wall=7, wall=128 (progress_bar.py:262, log())
[2021-04-09 22:59:52]    INFO >> epoch 001 | loss 0.993 | mrr 0.399198 | sample_size 1000 | wps 17740.8 | ups 17.74 | wpb 1000 | bsz 1000 | num_updates 1880 | lr 0.01 | gnorm 0.013 | clip 0.1 | train_wall 33 | wall 150 (progress_bar.py:269, print())
[2021-04-09 23:00:05]    INFO >> epoch 001 | valid on 'valid' subset | loss 0.995 | mrr 0.564301 | sample_size 1000 | wps 16551.2 | wpb 1000 | bsz 1000 | num_updates 1880 (progress_bar.py:269, print())
[2021-04-09 23:00:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 1880 updates, score 0.564301) (writing took 1.769517 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:00:19]    INFO >> epoch 002:    120 / 1881 loss=0.97, mrr=611.437, sample_size=1000, wps=10110.2, ups=10.11, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.016, clip=0, train_wall=7, wall=178 (progress_bar.py:262, log())
[2021-04-09 23:00:49]    INFO >> epoch 002:    621 / 1881 loss=0.951, mrr=673.829, sample_size=1000, wps=16902.2, ups=16.9, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.02, clip=0, train_wall=7, wall=207 (progress_bar.py:262, log())
[2021-04-09 23:01:18]    INFO >> epoch 002:   1121 / 1881 loss=0.94, mrr=697.559, sample_size=1000, wps=16948.6, ups=16.95, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.021, clip=0, train_wall=7, wall=237 (progress_bar.py:262, log())
[2021-04-09 23:01:48]    INFO >> epoch 002:   1621 / 1881 loss=0.933, mrr=710.676, sample_size=1000, wps=16824.2, ups=16.82, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.021, clip=0, train_wall=8, wall=266 (progress_bar.py:262, log())
[2021-04-09 23:02:05]    INFO >> epoch 002 | loss 0.941 | mrr 0.695027 | sample_size 1000 | wps 14148.8 | ups 14.15 | wpb 1000 | bsz 1000 | num_updates 3760 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 29 | wall 283 (progress_bar.py:269, print())
[2021-04-09 23:02:14]    INFO >> epoch 002 | valid on 'valid' subset | loss 0.969 | mrr 0.644711 | sample_size 1000 | wps 15232.8 | wpb 1000 | bsz 1000 | num_updates 3760 | best_mrr 644.711 (progress_bar.py:269, print())
[2021-04-09 23:02:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 3760 updates, score 0.644711) (writing took 0.681468 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:02:38]    INFO >> epoch 003:    240 / 1881 loss=0.919, mrr=736.948, sample_size=1000, wps=9989.4, ups=9.99, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.022, clip=0, train_wall=21, wall=317 (progress_bar.py:262, log())
[2021-04-09 23:03:17]    INFO >> epoch 003:    741 / 1881 loss=0.911, mrr=750.038, sample_size=1000, wps=12773.3, ups=12.77, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.022, clip=0, train_wall=35, wall=356 (progress_bar.py:262, log())
[2021-04-09 23:03:56]    INFO >> epoch 003:   1241 / 1881 loss=0.912, mrr=747.853, sample_size=1000, wps=12776.5, ups=12.78, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.023, clip=0, train_wall=35, wall=395 (progress_bar.py:262, log())
[2021-04-09 23:04:35]    INFO >> epoch 003:   1741 / 1881 loss=0.912, mrr=746.966, sample_size=1000, wps=12734.2, ups=12.73, wpb=1000, bsz=1000, num_updates=5500, lr=0.01, gnorm=0.024, clip=0, train_wall=35, wall=434 (progress_bar.py:262, log())
[2021-04-09 23:04:47]    INFO >> epoch 003 | loss 0.911 | mrr 0.749187 | sample_size 1000 | wps 11602.9 | ups 11.6 | wpb 1000 | bsz 1000 | num_updates 5640 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 130 | wall 445 (progress_bar.py:269, print())
[2021-04-09 23:05:00]    INFO >> epoch 003 | valid on 'valid' subset | loss 0.962 | mrr 0.654916 | sample_size 1000 | wps 16229.2 | wpb 1000 | bsz 1000 | num_updates 5640 | best_mrr 654.916 (progress_bar.py:269, print())
[2021-04-09 23:05:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 5640 updates, score 0.654916) (writing took 0.763166 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:05:34]    INFO >> epoch 004:    360 / 1881 loss=0.9, mrr=766.293, sample_size=1000, wps=8494.1, ups=8.49, wpb=1000, bsz=1000, num_updates=6000, lr=0.01, gnorm=0.024, clip=0, train_wall=35, wall=493 (progress_bar.py:262, log())
[2021-04-09 23:06:43]    INFO >> epoch 004:    860 / 1881 loss=0.899, mrr=768.548, sample_size=1000, wps=7288.7, ups=7.29, wpb=1000, bsz=1000, num_updates=6500, lr=0.01, gnorm=0.025, clip=0, train_wall=64, wall=562 (progress_bar.py:262, log())
[2021-04-09 23:08:01]    INFO >> epoch 004:   1361 / 1881 loss=0.902, mrr=763.788, sample_size=1000, wps=6403.5, ups=6.4, wpb=1000, bsz=1000, num_updates=7000, lr=0.01, gnorm=0.025, clip=0, train_wall=73, wall=640 (progress_bar.py:262, log())
[2021-04-09 23:09:21]    INFO >> epoch 004:   1861 / 1881 loss=0.902, mrr=761.631, sample_size=1000, wps=6227.7, ups=6.23, wpb=1000, bsz=1000, num_updates=7500, lr=0.01, gnorm=0.026, clip=0, train_wall=76, wall=720 (progress_bar.py:262, log())
[2021-04-09 23:09:25]    INFO >> epoch 004 | loss 0.9 | mrr 0.766496 | sample_size 1000 | wps 6761.1 | ups 6.76 | wpb 1000 | bsz 1000 | num_updates 7520 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 241 | wall 723 (progress_bar.py:269, print())
[2021-04-09 23:09:40]    INFO >> epoch 004 | valid on 'valid' subset | loss 0.959 | mrr 0.659694 | sample_size 1000 | wps 11398.8 | wpb 1000 | bsz 1000 | num_updates 7520 | best_mrr 659.694 (progress_bar.py:269, print())
[2021-04-09 23:09:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 7520 updates, score 0.659694) (writing took 0.827755 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:11:04]    INFO >> epoch 005:    480 / 1881 loss=0.89, mrr=782.047, sample_size=1000, wps=4883.4, ups=4.88, wpb=1000, bsz=1000, num_updates=8000, lr=0.01, gnorm=0.027, clip=0, train_wall=75, wall=822 (progress_bar.py:262, log())
[2021-04-09 23:12:24]    INFO >> epoch 005:    981 / 1881 loss=0.894, mrr=775.63, sample_size=1000, wps=6239.1, ups=6.24, wpb=1000, bsz=1000, num_updates=8500, lr=0.01, gnorm=0.028, clip=0, train_wall=75, wall=902 (progress_bar.py:262, log())
[2021-04-09 23:13:44]    INFO >> epoch 005:   1481 / 1881 loss=0.895, mrr=772.956, sample_size=1000, wps=6232.4, ups=6.23, wpb=1000, bsz=1000, num_updates=9000, lr=0.01, gnorm=0.028, clip=0, train_wall=75, wall=983 (progress_bar.py:262, log())
[2021-04-09 23:14:43]    INFO >> epoch 005 | loss 0.894 | mrr 0.775053 | sample_size 1000 | wps 5899.4 | ups 5.9 | wpb 1000 | bsz 1000 | num_updates 9400 | lr 0.01 | gnorm 0.028 | clip 0 | train_wall 277 | wall 1042 (progress_bar.py:269, print())
[2021-04-09 23:14:55]    INFO >> epoch 005 | valid on 'valid' subset | loss 0.958 | mrr 0.661311 | sample_size 1000 | wps 11108.8 | wpb 1000 | bsz 1000 | num_updates 9400 | best_mrr 661.311 (progress_bar.py:269, print())
[2021-04-09 23:14:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 9400 updates, score 0.661311) (writing took 0.963887 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:15:18]    INFO >> epoch 006:    101 / 1881 loss=0.895, mrr=771.774, sample_size=1000, wps=5300.3, ups=5.3, wpb=1000, bsz=1000, num_updates=9500, lr=0.01, gnorm=0.029, clip=0, train_wall=69, wall=1077 (progress_bar.py:262, log())
[2021-04-09 23:16:39]    INFO >> epoch 006:    601 / 1881 loss=0.887, mrr=786.79, sample_size=1000, wps=6224.5, ups=6.22, wpb=1000, bsz=1000, num_updates=10000, lr=0.01, gnorm=0.03, clip=0, train_wall=75, wall=1157 (progress_bar.py:262, log())
[2021-04-09 23:17:59]    INFO >> epoch 006:   1101 / 1881 loss=0.891, mrr=779.688, sample_size=1000, wps=6219.3, ups=6.22, wpb=1000, bsz=1000, num_updates=10500, lr=0.01, gnorm=0.03, clip=0, train_wall=76, wall=1238 (progress_bar.py:262, log())
[2021-04-09 23:19:19]    INFO >> epoch 006:   1601 / 1881 loss=0.892, mrr=777.091, sample_size=1000, wps=6249.8, ups=6.25, wpb=1000, bsz=1000, num_updates=11000, lr=0.01, gnorm=0.031, clip=0, train_wall=75, wall=1318 (progress_bar.py:262, log())
[2021-04-09 23:20:04]    INFO >> epoch 006 | loss 0.89 | mrr 0.780524 | sample_size 1000 | wps 5868.2 | ups 5.87 | wpb 1000 | bsz 1000 | num_updates 11280 | lr 0.01 | gnorm 0.03 | clip 0 | train_wall 283 | wall 1362 (progress_bar.py:269, print())
[2021-04-09 23:20:19]    INFO >> epoch 006 | valid on 'valid' subset | loss 0.957 | mrr 0.66138 | sample_size 1000 | wps 11519.4 | wpb 1000 | bsz 1000 | num_updates 11280 | best_mrr 661.38 (progress_bar.py:269, print())
[2021-04-09 23:20:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 6 @ 11280 updates, score 0.66138) (writing took 0.998616 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:21:04]    INFO >> epoch 007:    220 / 1881 loss=0.888, mrr=783.263, sample_size=1000, wps=4778, ups=4.78, wpb=1000, bsz=1000, num_updates=11500, lr=0.01, gnorm=0.032, clip=0, train_wall=76, wall=1422 (progress_bar.py:262, log())
[2021-04-09 23:22:24]    INFO >> epoch 007:    720 / 1881 loss=0.884, mrr=788.899, sample_size=1000, wps=6221.8, ups=6.22, wpb=1000, bsz=1000, num_updates=12000, lr=0.01, gnorm=0.032, clip=0, train_wall=76, wall=1503 (progress_bar.py:262, log())
[2021-04-09 23:23:43]    INFO >> epoch 007:   1220 / 1881 loss=0.888, mrr=783.928, sample_size=1000, wps=6317.9, ups=6.32, wpb=1000, bsz=1000, num_updates=12500, lr=0.01, gnorm=0.033, clip=0, train_wall=74, wall=1582 (progress_bar.py:262, log())
[2021-04-09 23:25:03]    INFO >> epoch 007:   1721 / 1881 loss=0.89, mrr=780.307, sample_size=1000, wps=6275.2, ups=6.28, wpb=1000, bsz=1000, num_updates=13000, lr=0.01, gnorm=0.033, clip=0, train_wall=75, wall=1662 (progress_bar.py:262, log())
[2021-04-09 23:25:29]    INFO >> epoch 007 | loss 0.887 | mrr 0.785143 | sample_size 1000 | wps 5788.1 | ups 5.79 | wpb 1000 | bsz 1000 | num_updates 13160 | lr 0.01 | gnorm 0.033 | clip 0 | train_wall 283 | wall 1687 (progress_bar.py:269, print())
[2021-04-09 23:25:44]    INFO >> epoch 007 | valid on 'valid' subset | loss 0.956 | mrr 0.662395 | sample_size 1000 | wps 11658.1 | wpb 1000 | bsz 1000 | num_updates 13160 | best_mrr 662.395 (progress_bar.py:269, print())
[2021-04-09 23:25:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 7 @ 13160 updates, score 0.662395) (writing took 1.064310 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:26:45]    INFO >> epoch 008:    340 / 1881 loss=0.883, mrr=790.667, sample_size=1000, wps=4913.7, ups=4.91, wpb=1000, bsz=1000, num_updates=13500, lr=0.01, gnorm=0.034, clip=0, train_wall=74, wall=1763 (progress_bar.py:262, log())
[2021-04-09 23:28:05]    INFO >> epoch 008:    841 / 1881 loss=0.883, mrr=791.032, sample_size=1000, wps=6215.7, ups=6.22, wpb=1000, bsz=1000, num_updates=14000, lr=0.01, gnorm=0.034, clip=0, train_wall=76, wall=1844 (progress_bar.py:262, log())
[2021-04-09 23:29:25]    INFO >> epoch 008:   1341 / 1881 loss=0.886, mrr=785.725, sample_size=1000, wps=6229.8, ups=6.23, wpb=1000, bsz=1000, num_updates=14500, lr=0.01, gnorm=0.035, clip=0, train_wall=76, wall=1924 (progress_bar.py:262, log())
[2021-04-09 23:30:46]    INFO >> epoch 008:   1841 / 1881 loss=0.887, mrr=783.366, sample_size=1000, wps=6198.6, ups=6.2, wpb=1000, bsz=1000, num_updates=15000, lr=0.01, gnorm=0.036, clip=0, train_wall=76, wall=2005 (progress_bar.py:262, log())
[2021-04-09 23:30:52]    INFO >> epoch 008 | loss 0.884 | mrr 0.788272 | sample_size 1000 | wps 5802.8 | ups 5.8 | wpb 1000 | bsz 1000 | num_updates 15040 | lr 0.01 | gnorm 0.035 | clip 0 | train_wall 283 | wall 2011 (progress_bar.py:269, print())
[2021-04-09 23:31:09]    INFO >> epoch 008 | valid on 'valid' subset | loss 0.955 | mrr 0.662825 | sample_size 1000 | wps 10867.9 | wpb 1000 | bsz 1000 | num_updates 15040 | best_mrr 662.825 (progress_bar.py:269, print())
[2021-04-09 23:31:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 8 @ 15040 updates, score 0.662825) (writing took 0.842885 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:32:25]    INFO >> epoch 009:    461 / 1881 loss=0.879, mrr=796.679, sample_size=1000, wps=5036.4, ups=5.04, wpb=1000, bsz=1000, num_updates=15500, lr=0.01, gnorm=0.036, clip=0, train_wall=70, wall=2104 (progress_bar.py:262, log())
[2021-04-09 23:33:37]    INFO >> epoch 009:    961 / 1881 loss=0.881, mrr=792.026, sample_size=1000, wps=6983.9, ups=6.98, wpb=1000, bsz=1000, num_updates=16000, lr=0.01, gnorm=0.037, clip=0, train_wall=66, wall=2176 (progress_bar.py:262, log())
[2021-04-09 23:34:55]    INFO >> epoch 009:   1461 / 1881 loss=0.884, mrr=787.396, sample_size=1000, wps=6372.9, ups=6.37, wpb=1000, bsz=1000, num_updates=16500, lr=0.01, gnorm=0.037, clip=0, train_wall=74, wall=2254 (progress_bar.py:262, log())
[2021-04-09 23:36:02]    INFO >> epoch 009 | loss 0.882 | mrr 0.790576 | sample_size 1000 | wps 6071.4 | ups 6.07 | wpb 1000 | bsz 1000 | num_updates 16920 | lr 0.01 | gnorm 0.037 | clip 0 | train_wall 267 | wall 2321 (progress_bar.py:269, print())
[2021-04-09 23:36:18]    INFO >> epoch 009 | valid on 'valid' subset | loss 0.956 | mrr 0.662506 | sample_size 1000 | wps 11446.8 | wpb 1000 | bsz 1000 | num_updates 16920 | best_mrr 662.506 (progress_bar.py:269, print())
[2021-04-09 23:36:18]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 9 @ 16920 updates, score 0.662506) (writing took 0.412136 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:36:36]    INFO >> epoch 010:     80 / 1881 loss=0.884, mrr=787.44, sample_size=1000, wps=4949.2, ups=4.95, wpb=1000, bsz=1000, num_updates=17000, lr=0.01, gnorm=0.037, clip=0, train_wall=74, wall=2355 (progress_bar.py:262, log())
[2021-04-09 23:37:56]    INFO >> epoch 010:    580 / 1881 loss=0.877, mrr=798.619, sample_size=1000, wps=6247, ups=6.25, wpb=1000, bsz=1000, num_updates=17500, lr=0.01, gnorm=0.038, clip=0, train_wall=75, wall=2435 (progress_bar.py:262, log())
[2021-04-09 23:39:15]    INFO >> epoch 010:   1081 / 1881 loss=0.881, mrr=792.084, sample_size=1000, wps=6351.2, ups=6.35, wpb=1000, bsz=1000, num_updates=18000, lr=0.01, gnorm=0.039, clip=0, train_wall=74, wall=2514 (progress_bar.py:262, log())
[2021-04-09 23:40:36]    INFO >> epoch 010:   1581 / 1881 loss=0.883, mrr=789.069, sample_size=1000, wps=6200.6, ups=6.2, wpb=1000, bsz=1000, num_updates=18500, lr=0.01, gnorm=0.039, clip=0, train_wall=76, wall=2595 (progress_bar.py:262, log())
[2021-04-09 23:41:24]    INFO >> epoch 010 | loss 0.881 | mrr 0.792538 | sample_size 1000 | wps 5836.8 | ups 5.84 | wpb 1000 | bsz 1000 | num_updates 18800 | lr 0.01 | gnorm 0.039 | clip 0 | train_wall 282 | wall 2643 (progress_bar.py:269, print())
[2021-04-09 23:41:40]    INFO >> epoch 010 | valid on 'valid' subset | loss 0.955 | mrr 0.662055 | sample_size 1000 | wps 11455 | wpb 1000 | bsz 1000 | num_updates 18800 | best_mrr 662.055 (progress_bar.py:269, print())
[2021-04-09 23:41:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 10 @ 18800 updates, score 0.662055) (writing took 0.422666 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:42:17]    INFO >> epoch 011:    200 / 1881 loss=0.88, mrr=793.492, sample_size=1000, wps=4942.2, ups=4.94, wpb=1000, bsz=1000, num_updates=19000, lr=0.01, gnorm=0.039, clip=0, train_wall=75, wall=2696 (progress_bar.py:262, log())
[2021-04-09 23:43:37]    INFO >> epoch 011:    700 / 1881 loss=0.877, mrr=799.079, sample_size=1000, wps=6256.7, ups=6.26, wpb=1000, bsz=1000, num_updates=19500, lr=0.01, gnorm=0.04, clip=0, train_wall=75, wall=2776 (progress_bar.py:262, log())
[2021-04-09 23:44:57]    INFO >> epoch 011:   1201 / 1881 loss=0.881, mrr=793.326, sample_size=1000, wps=6228.2, ups=6.23, wpb=1000, bsz=1000, num_updates=20000, lr=0.01, gnorm=0.04, clip=0, train_wall=75, wall=2856 (progress_bar.py:262, log())
[2021-04-09 23:46:17]    INFO >> epoch 011:   1701 / 1881 loss=0.882, mrr=790.319, sample_size=1000, wps=6240.8, ups=6.24, wpb=1000, bsz=1000, num_updates=20500, lr=0.01, gnorm=0.041, clip=0, train_wall=75, wall=2936 (progress_bar.py:262, log())
[2021-04-09 23:46:46]    INFO >> epoch 011 | loss 0.879 | mrr 0.79497 | sample_size 1000 | wps 5847 | ups 5.85 | wpb 1000 | bsz 1000 | num_updates 20680 | lr 0.01 | gnorm 0.04 | clip 0 | train_wall 281 | wall 2965 (progress_bar.py:269, print())
[2021-04-09 23:47:01]    INFO >> epoch 011 | valid on 'valid' subset | loss 0.954 | mrr 0.663129 | sample_size 1000 | wps 11484.4 | wpb 1000 | bsz 1000 | num_updates 20680 | best_mrr 663.129 (progress_bar.py:269, print())
[2021-04-09 23:47:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 11 @ 20680 updates, score 0.663129) (writing took 0.758647 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:47:53]    INFO >> epoch 012:    320 / 1881 loss=0.876, mrr=799.627, sample_size=1000, wps=5206.8, ups=5.21, wpb=1000, bsz=1000, num_updates=21000, lr=0.01, gnorm=0.041, clip=0, train_wall=67, wall=3032 (progress_bar.py:262, log())
[2021-04-09 23:49:14]    INFO >> epoch 012:    820 / 1881 loss=0.876, mrr=798.707, sample_size=1000, wps=6242.9, ups=6.24, wpb=1000, bsz=1000, num_updates=21500, lr=0.01, gnorm=0.042, clip=0, train_wall=75, wall=3112 (progress_bar.py:262, log())
[2021-04-09 23:50:34]    INFO >> epoch 012:   1320 / 1881 loss=0.879, mrr=794.357, sample_size=1000, wps=6213.8, ups=6.21, wpb=1000, bsz=1000, num_updates=22000, lr=0.01, gnorm=0.042, clip=0, train_wall=76, wall=3193 (progress_bar.py:262, log())
[2021-04-09 23:51:54]    INFO >> epoch 012:   1821 / 1881 loss=0.882, mrr=790.545, sample_size=1000, wps=6257.2, ups=6.26, wpb=1000, bsz=1000, num_updates=22500, lr=0.01, gnorm=0.042, clip=0, train_wall=75, wall=3273 (progress_bar.py:262, log())
[2021-04-09 23:52:04]    INFO >> epoch 012 | loss 0.878 | mrr 0.796122 | sample_size 1000 | wps 5915.4 | ups 5.92 | wpb 1000 | bsz 1000 | num_updates 22560 | lr 0.01 | gnorm 0.042 | clip 0 | train_wall 275 | wall 3282 (progress_bar.py:269, print())
[2021-04-09 23:52:19]    INFO >> epoch 012 | valid on 'valid' subset | loss 0.954 | mrr 0.663156 | sample_size 1000 | wps 11374.3 | wpb 1000 | bsz 1000 | num_updates 22560 | best_mrr 663.156 (progress_bar.py:269, print())
[2021-04-09 23:52:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 12 @ 22560 updates, score 0.663156) (writing took 0.775334 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:53:36]    INFO >> epoch 013:    440 / 1881 loss=0.874, mrr=802.643, sample_size=1000, wps=4890.3, ups=4.89, wpb=1000, bsz=1000, num_updates=23000, lr=0.01, gnorm=0.043, clip=0, train_wall=75, wall=3375 (progress_bar.py:262, log())
[2021-04-09 23:54:55]    INFO >> epoch 013:    940 / 1881 loss=0.876, mrr=799.512, sample_size=1000, wps=6346.8, ups=6.35, wpb=1000, bsz=1000, num_updates=23500, lr=0.01, gnorm=0.043, clip=0, train_wall=74, wall=3454 (progress_bar.py:262, log())
[2021-04-09 23:56:15]    INFO >> epoch 013:   1440 / 1881 loss=0.879, mrr=794.474, sample_size=1000, wps=6269.9, ups=6.27, wpb=1000, bsz=1000, num_updates=24000, lr=0.01, gnorm=0.043, clip=0, train_wall=75, wall=3533 (progress_bar.py:262, log())
[2021-04-09 23:57:25]    INFO >> epoch 013 | loss 0.877 | mrr 0.79727 | sample_size 1000 | wps 5849.9 | ups 5.85 | wpb 1000 | bsz 1000 | num_updates 24440 | lr 0.01 | gnorm 0.043 | clip 0 | train_wall 281 | wall 3604 (progress_bar.py:269, print())
[2021-04-09 23:57:42]    INFO >> epoch 013 | valid on 'valid' subset | loss 0.954 | mrr 0.662302 | sample_size 1000 | wps 11325.5 | wpb 1000 | bsz 1000 | num_updates 24440 | best_mrr 662.302 (progress_bar.py:269, print())
[2021-04-09 23:57:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 24440 updates, score 0.662302) (writing took 0.427714 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:57:58]    INFO >> epoch 014:     60 / 1881 loss=0.88, mrr=792.612, sample_size=1000, wps=4844.4, ups=4.84, wpb=1000, bsz=1000, num_updates=24500, lr=0.01, gnorm=0.044, clip=0, train_wall=75, wall=3637 (progress_bar.py:262, log())
[2021-04-09 23:59:18]    INFO >> epoch 014:    560 / 1881 loss=0.872, mrr=804.903, sample_size=1000, wps=6251.4, ups=6.25, wpb=1000, bsz=1000, num_updates=25000, lr=0.01, gnorm=0.044, clip=0, train_wall=75, wall=3717 (progress_bar.py:262, log())
[2021-04-10 00:00:38]    INFO >> epoch 014:   1060 / 1881 loss=0.876, mrr=798.67, sample_size=1000, wps=6222.7, ups=6.22, wpb=1000, bsz=1000, num_updates=25500, lr=0.01, gnorm=0.044, clip=0, train_wall=75, wall=3797 (progress_bar.py:262, log())
[2021-04-10 00:01:52]    INFO >> epoch 014:   1560 / 1881 loss=0.878, mrr=795.037, sample_size=1000, wps=6789, ups=6.79, wpb=1000, bsz=1000, num_updates=26000, lr=0.01, gnorm=0.045, clip=0, train_wall=68, wall=3871 (progress_bar.py:262, log())
[2021-04-10 00:02:40]    INFO >> epoch 014 | loss 0.876 | mrr 0.798631 | sample_size 1000 | wps 5974 | ups 5.97 | wpb 1000 | bsz 1000 | num_updates 26320 | lr 0.01 | gnorm 0.045 | clip 0 | train_wall 272 | wall 3918 (progress_bar.py:269, print())
[2021-04-10 00:02:55]    INFO >> epoch 014 | valid on 'valid' subset | loss 0.954 | mrr 0.662501 | sample_size 1000 | wps 11444.9 | wpb 1000 | bsz 1000 | num_updates 26320 | best_mrr 662.501 (progress_bar.py:269, print())
[2021-04-10 00:02:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 26320 updates, score 0.662501) (writing took 0.543895 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:03:29]    INFO >> epoch 015:    180 / 1881 loss=0.876, mrr=798.42, sample_size=1000, wps=5156.9, ups=5.16, wpb=1000, bsz=1000, num_updates=26500, lr=0.01, gnorm=0.045, clip=0, train_wall=69, wall=3968 (progress_bar.py:262, log())
[2021-04-10 00:04:42]    INFO >> epoch 015:    680 / 1881 loss=0.873, mrr=804.091, sample_size=1000, wps=6880.4, ups=6.88, wpb=1000, bsz=1000, num_updates=27000, lr=0.01, gnorm=0.046, clip=0, train_wall=66, wall=4040 (progress_bar.py:262, log())
[2021-04-10 00:06:01]    INFO >> epoch 015:   1181 / 1881 loss=0.876, mrr=799.032, sample_size=1000, wps=6285.3, ups=6.29, wpb=1000, bsz=1000, num_updates=27500, lr=0.01, gnorm=0.046, clip=0, train_wall=74, wall=4120 (progress_bar.py:262, log())
[2021-04-10 00:07:21]    INFO >> epoch 015:   1681 / 1881 loss=0.878, mrr=795.745, sample_size=1000, wps=6275, ups=6.27, wpb=1000, bsz=1000, num_updates=28000, lr=0.01, gnorm=0.046, clip=0, train_wall=75, wall=4199 (progress_bar.py:262, log())
[2021-04-10 00:07:53]    INFO >> epoch 015 | loss 0.875 | mrr 0.799803 | sample_size 1000 | wps 6008.4 | ups 6.01 | wpb 1000 | bsz 1000 | num_updates 28200 | lr 0.01 | gnorm 0.046 | clip 0 | train_wall 271 | wall 4231 (progress_bar.py:269, print())
[2021-04-10 00:08:08]    INFO >> epoch 015 | valid on 'valid' subset | loss 0.954 | mrr 0.662059 | sample_size 1000 | wps 11327.4 | wpb 1000 | bsz 1000 | num_updates 28200 | best_mrr 662.059 (progress_bar.py:269, print())
[2021-04-10 00:08:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 28200 updates, score 0.662059) (writing took 0.553980 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:09:04]    INFO >> epoch 016:    300 / 1881 loss=0.874, mrr=801.819, sample_size=1000, wps=4856.4, ups=4.86, wpb=1000, bsz=1000, num_updates=28500, lr=0.01, gnorm=0.047, clip=0, train_wall=76, wall=4302 (progress_bar.py:262, log())
[2021-04-10 00:10:23]    INFO >> epoch 016:    800 / 1881 loss=0.873, mrr=803.349, sample_size=1000, wps=6273.1, ups=6.27, wpb=1000, bsz=1000, num_updates=29000, lr=0.01, gnorm=0.047, clip=0, train_wall=75, wall=4382 (progress_bar.py:262, log())
[2021-04-10 00:11:42]    INFO >> epoch 016:   1301 / 1881 loss=0.875, mrr=799.251, sample_size=1000, wps=6326.1, ups=6.33, wpb=1000, bsz=1000, num_updates=29500, lr=0.01, gnorm=0.047, clip=0, train_wall=74, wall=4461 (progress_bar.py:262, log())
[2021-04-10 00:13:03]    INFO >> epoch 016:   1801 / 1881 loss=0.877, mrr=795.944, sample_size=1000, wps=6236.1, ups=6.24, wpb=1000, bsz=1000, num_updates=30000, lr=0.01, gnorm=0.047, clip=0, train_wall=75, wall=4541 (progress_bar.py:262, log())
[2021-04-10 00:13:16]    INFO >> epoch 016 | loss 0.875 | mrr 0.8006 | sample_size 1000 | wps 5822.3 | ups 5.82 | wpb 1000 | bsz 1000 | num_updates 30080 | lr 0.01 | gnorm 0.047 | clip 0 | train_wall 282 | wall 4554 (progress_bar.py:269, print())
[2021-04-10 00:13:31]    INFO >> epoch 016 | valid on 'valid' subset | loss 0.954 | mrr 0.662907 | sample_size 1000 | wps 11141.7 | wpb 1000 | bsz 1000 | num_updates 30080 | best_mrr 662.907 (progress_bar.py:269, print())
[2021-04-10 00:13:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 30080 updates, score 0.662907) (writing took 0.438922 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:14:43]    INFO >> epoch 017:    420 / 1881 loss=0.871, mrr=805.645, sample_size=1000, wps=4979.6, ups=4.98, wpb=1000, bsz=1000, num_updates=30500, lr=0.01, gnorm=0.048, clip=0, train_wall=74, wall=4642 (progress_bar.py:262, log())
[2021-04-10 00:16:04]    INFO >> epoch 017:    920 / 1881 loss=0.873, mrr=803.124, sample_size=1000, wps=6200.6, ups=6.2, wpb=1000, bsz=1000, num_updates=31000, lr=0.01, gnorm=0.048, clip=0, train_wall=76, wall=4722 (progress_bar.py:262, log())
[2021-04-10 00:17:24]    INFO >> epoch 017:   1421 / 1881 loss=0.876, mrr=798.795, sample_size=1000, wps=6230.8, ups=6.23, wpb=1000, bsz=1000, num_updates=31500, lr=0.01, gnorm=0.048, clip=0, train_wall=75, wall=4803 (progress_bar.py:262, log())
[2021-04-10 00:18:38]    INFO >> epoch 017 | loss 0.874 | mrr 0.801312 | sample_size 1000 | wps 5836.2 | ups 5.84 | wpb 1000 | bsz 1000 | num_updates 31960 | lr 0.01 | gnorm 0.048 | clip 0 | train_wall 282 | wall 4876 (progress_bar.py:269, print())
[2021-04-10 00:18:54]    INFO >> epoch 017 | valid on 'valid' subset | loss 0.954 | mrr 0.662222 | sample_size 1000 | wps 10932.7 | wpb 1000 | bsz 1000 | num_updates 31960 | best_mrr 662.222 (progress_bar.py:269, print())
[2021-04-10 00:18:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 17 @ 31960 updates, score 0.662222) (writing took 0.429670 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:19:06]    INFO >> epoch 018:     40 / 1881 loss=0.877, mrr=797.447, sample_size=1000, wps=4908.9, ups=4.91, wpb=1000, bsz=1000, num_updates=32000, lr=0.01, gnorm=0.049, clip=0, train_wall=75, wall=4905 (progress_bar.py:262, log())
[2021-04-10 00:20:21]    INFO >> epoch 018:    540 / 1881 loss=0.869, mrr=807.961, sample_size=1000, wps=6622.6, ups=6.62, wpb=1000, bsz=1000, num_updates=32500, lr=0.01, gnorm=0.049, clip=0, train_wall=70, wall=4980 (progress_bar.py:262, log())
[2021-04-10 00:21:38]    INFO >> epoch 018:   1040 / 1881 loss=0.873, mrr=802.073, sample_size=1000, wps=6528.1, ups=6.53, wpb=1000, bsz=1000, num_updates=33000, lr=0.01, gnorm=0.049, clip=0, train_wall=71, wall=5057 (progress_bar.py:262, log())
[2021-04-10 00:22:58]    INFO >> epoch 018:   1541 / 1881 loss=0.875, mrr=799.006, sample_size=1000, wps=6264, ups=6.26, wpb=1000, bsz=1000, num_updates=33500, lr=0.01, gnorm=0.049, clip=0, train_wall=75, wall=5136 (progress_bar.py:262, log())
[2021-04-10 00:23:51]    INFO >> epoch 018 | loss 0.873 | mrr 0.801829 | sample_size 1000 | wps 5999.6 | ups 6 | wpb 1000 | bsz 1000 | num_updates 33840 | lr 0.01 | gnorm 0.049 | clip 0 | train_wall 271 | wall 5190 (progress_bar.py:269, print())
[2021-04-10 00:24:07]    INFO >> epoch 018 | valid on 'valid' subset | loss 0.954 | mrr 0.662419 | sample_size 1000 | wps 11551 | wpb 1000 | bsz 1000 | num_updates 33840 | best_mrr 662.419 (progress_bar.py:269, print())
[2021-04-10 00:24:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 33840 updates, score 0.662419) (writing took 0.472511 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:24:39]    INFO >> epoch 019:    160 / 1881 loss=0.874, mrr=800.298, sample_size=1000, wps=4922, ups=4.92, wpb=1000, bsz=1000, num_updates=34000, lr=0.01, gnorm=0.05, clip=0, train_wall=75, wall=5238 (progress_bar.py:262, log())
[2021-04-10 00:25:59]    INFO >> epoch 019:    660 / 1881 loss=0.87, mrr=807.418, sample_size=1000, wps=6249.8, ups=6.25, wpb=1000, bsz=1000, num_updates=34500, lr=0.01, gnorm=0.05, clip=0, train_wall=75, wall=5318 (progress_bar.py:262, log())
[2021-04-10 00:27:18]    INFO >> epoch 019:   1161 / 1881 loss=0.873, mrr=801.612, sample_size=1000, wps=6398.6, ups=6.4, wpb=1000, bsz=1000, num_updates=35000, lr=0.01, gnorm=0.05, clip=0, train_wall=73, wall=5396 (progress_bar.py:262, log())
[2021-04-10 00:28:37]    INFO >> epoch 019:   1661 / 1881 loss=0.875, mrr=799.083, sample_size=1000, wps=6252.9, ups=6.25, wpb=1000, bsz=1000, num_updates=35500, lr=0.01, gnorm=0.05, clip=0, train_wall=75, wall=5476 (progress_bar.py:262, log())
[2021-04-10 00:29:14]    INFO >> epoch 019 | loss 0.873 | mrr 0.802836 | sample_size 1000 | wps 5824.9 | ups 5.82 | wpb 1000 | bsz 1000 | num_updates 35720 | lr 0.01 | gnorm 0.05 | clip 0 | train_wall 283 | wall 5512 (progress_bar.py:269, print())
[2021-04-10 00:29:29]    INFO >> epoch 019 | valid on 'valid' subset | loss 0.954 | mrr 0.662013 | sample_size 1000 | wps 11290.3 | wpb 1000 | bsz 1000 | num_updates 35720 | best_mrr 662.013 (progress_bar.py:269, print())
[2021-04-10 00:29:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 35720 updates, score 0.662013) (writing took 0.507617 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:30:12]    INFO >> epoch 020:    281 / 1881 loss=0.871, mrr=805.683, sample_size=1000, wps=5275.8, ups=5.28, wpb=1000, bsz=1000, num_updates=36000, lr=0.01, gnorm=0.051, clip=0, train_wall=68, wall=5571 (progress_bar.py:262, log())
[2021-04-10 00:31:27]    INFO >> epoch 020:    781 / 1881 loss=0.87, mrr=806.688, sample_size=1000, wps=6721.7, ups=6.72, wpb=1000, bsz=1000, num_updates=36500, lr=0.01, gnorm=0.051, clip=0, train_wall=70, wall=5645 (progress_bar.py:262, log())
[2021-04-10 00:32:47]    INFO >> epoch 020:   1281 / 1881 loss=0.873, mrr=802.012, sample_size=1000, wps=6259.2, ups=6.26, wpb=1000, bsz=1000, num_updates=37000, lr=0.01, gnorm=0.051, clip=0, train_wall=75, wall=5725 (progress_bar.py:262, log())
[2021-04-10 00:34:06]    INFO >> epoch 020:   1781 / 1881 loss=0.875, mrr=799.254, sample_size=1000, wps=6260.1, ups=6.26, wpb=1000, bsz=1000, num_updates=37500, lr=0.01, gnorm=0.051, clip=0, train_wall=75, wall=5805 (progress_bar.py:262, log())
[2021-04-10 00:34:22]    INFO >> epoch 020 | loss 0.872 | mrr 0.803706 | sample_size 1000 | wps 6093.9 | ups 6.09 | wpb 1000 | bsz 1000 | num_updates 37600 | lr 0.01 | gnorm 0.051 | clip 0 | train_wall 268 | wall 5821 (progress_bar.py:269, print())
[2021-04-10 00:34:38]    INFO >> epoch 020 | valid on 'valid' subset | loss 0.954 | mrr 0.66321 | sample_size 1000 | wps 11195.3 | wpb 1000 | bsz 1000 | num_updates 37600 | best_mrr 663.21 (progress_bar.py:269, print())
[2021-04-10 00:34:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_best.pt (epoch 20 @ 37600 updates, score 0.66321) (writing took 0.824747 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:35:49]    INFO >> epoch 021:    400 / 1881 loss=0.869, mrr=808.143, sample_size=1000, wps=4896, ups=4.9, wpb=1000, bsz=1000, num_updates=38000, lr=0.01, gnorm=0.052, clip=0, train_wall=75, wall=5907 (progress_bar.py:262, log())
[2021-04-10 00:37:01]    INFO >> epoch 021:    900 / 1881 loss=0.871, mrr=805.284, sample_size=1000, wps=6889.6, ups=6.89, wpb=1000, bsz=1000, num_updates=38500, lr=0.01, gnorm=0.052, clip=0, train_wall=65, wall=5980 (progress_bar.py:262, log())
[2021-04-10 00:38:21]    INFO >> epoch 021:   1401 / 1881 loss=0.873, mrr=802.624, sample_size=1000, wps=6237.6, ups=6.24, wpb=1000, bsz=1000, num_updates=39000, lr=0.01, gnorm=0.052, clip=0, train_wall=75, wall=6060 (progress_bar.py:262, log())
[2021-04-10 00:39:39]    INFO >> epoch 021 | loss 0.872 | mrr 0.804075 | sample_size 1000 | wps 5941.8 | ups 5.94 | wpb 1000 | bsz 1000 | num_updates 39480 | lr 0.01 | gnorm 0.052 | clip 0 | train_wall 273 | wall 6137 (progress_bar.py:269, print())
[2021-04-10 00:39:54]    INFO >> epoch 021 | valid on 'valid' subset | loss 0.953 | mrr 0.662946 | sample_size 1000 | wps 11751 | wpb 1000 | bsz 1000 | num_updates 39480 | best_mrr 662.946 (progress_bar.py:269, print())
[2021-04-10 00:39:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 21 @ 39480 updates, score 0.662946) (writing took 0.489212 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:40:03]    INFO >> epoch 022:     20 / 1881 loss=0.875, mrr=799.193, sample_size=1000, wps=4905.6, ups=4.91, wpb=1000, bsz=1000, num_updates=39500, lr=0.01, gnorm=0.052, clip=0, train_wall=75, wall=6162 (progress_bar.py:262, log())
[2021-04-10 00:41:24]    INFO >> epoch 022:    520 / 1881 loss=0.868, mrr=810.086, sample_size=1000, wps=6215.3, ups=6.22, wpb=1000, bsz=1000, num_updates=40000, lr=0.01, gnorm=0.053, clip=0, train_wall=76, wall=6242 (progress_bar.py:262, log())
[2021-04-10 00:42:44]    INFO >> epoch 022:   1020 / 1881 loss=0.871, mrr=805.258, sample_size=1000, wps=6255.8, ups=6.26, wpb=1000, bsz=1000, num_updates=40500, lr=0.01, gnorm=0.053, clip=0, train_wall=75, wall=6322 (progress_bar.py:262, log())
[2021-04-10 00:44:02]    INFO >> epoch 022:   1520 / 1881 loss=0.873, mrr=801.691, sample_size=1000, wps=6345.7, ups=6.35, wpb=1000, bsz=1000, num_updates=41000, lr=0.01, gnorm=0.053, clip=0, train_wall=74, wall=6401 (progress_bar.py:262, log())
[2021-04-10 00:45:01]    INFO >> epoch 022 | loss 0.871 | mrr 0.804564 | sample_size 1000 | wps 5841.3 | ups 5.84 | wpb 1000 | bsz 1000 | num_updates 41360 | lr 0.01 | gnorm 0.053 | clip 0 | train_wall 282 | wall 6459 (progress_bar.py:269, print())
[2021-04-10 00:45:16]    INFO >> epoch 022 | valid on 'valid' subset | loss 0.954 | mrr 0.662608 | sample_size 1000 | wps 11392.5 | wpb 1000 | bsz 1000 | num_updates 41360 | best_mrr 662.608 (progress_bar.py:269, print())
[2021-04-10 00:45:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 22 @ 41360 updates, score 0.662608) (writing took 0.486537 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:45:46]    INFO >> epoch 023:    140 / 1881 loss=0.872, mrr=803.19, sample_size=1000, wps=4837.2, ups=4.84, wpb=1000, bsz=1000, num_updates=41500, lr=0.01, gnorm=0.053, clip=0, train_wall=76, wall=6504 (progress_bar.py:262, log())
[2021-04-10 00:47:05]    INFO >> epoch 023:    640 / 1881 loss=0.868, mrr=809.467, sample_size=1000, wps=6336.7, ups=6.34, wpb=1000, bsz=1000, num_updates=42000, lr=0.01, gnorm=0.053, clip=0, train_wall=74, wall=6583 (progress_bar.py:262, log())
[2021-04-10 00:48:24]    INFO >> epoch 023:   1140 / 1881 loss=0.871, mrr=804.815, sample_size=1000, wps=6270.8, ups=6.27, wpb=1000, bsz=1000, num_updates=42500, lr=0.01, gnorm=0.053, clip=0, train_wall=75, wall=6663 (progress_bar.py:262, log())
[2021-04-10 00:49:45]    INFO >> epoch 023:   1640 / 1881 loss=0.873, mrr=801.761, sample_size=1000, wps=6245.2, ups=6.25, wpb=1000, bsz=1000, num_updates=43000, lr=0.01, gnorm=0.054, clip=0, train_wall=75, wall=6743 (progress_bar.py:262, log())
[2021-04-10 00:50:22]    INFO >> epoch 023 | loss 0.871 | mrr 0.805172 | sample_size 1000 | wps 5846 | ups 5.85 | wpb 1000 | bsz 1000 | num_updates 43240 | lr 0.01 | gnorm 0.054 | clip 0 | train_wall 281 | wall 6781 (progress_bar.py:269, print())
[2021-04-10 00:50:38]    INFO >> epoch 023 | valid on 'valid' subset | loss 0.953 | mrr 0.662966 | sample_size 1000 | wps 11928.4 | wpb 1000 | bsz 1000 | num_updates 43240 | best_mrr 662.966 (progress_bar.py:269, print())
[2021-04-10 00:50:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 23 @ 43240 updates, score 0.662966) (writing took 0.495190 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:51:24]    INFO >> epoch 024:    260 / 1881 loss=0.87, mrr=806.224, sample_size=1000, wps=5005.3, ups=5.01, wpb=1000, bsz=1000, num_updates=43500, lr=0.01, gnorm=0.054, clip=0, train_wall=73, wall=6843 (progress_bar.py:262, log())
[2021-04-10 00:52:34]    INFO >> epoch 024:    761 / 1881 loss=0.869, mrr=807.571, sample_size=1000, wps=7216.3, ups=7.22, wpb=1000, bsz=1000, num_updates=44000, lr=0.01, gnorm=0.054, clip=0, train_wall=63, wall=6912 (progress_bar.py:262, log())
[2021-04-10 00:53:47]    INFO >> epoch 024:   1261 / 1881 loss=0.871, mrr=804.352, sample_size=1000, wps=6796.8, ups=6.8, wpb=1000, bsz=1000, num_updates=44500, lr=0.01, gnorm=0.054, clip=0, train_wall=67, wall=6986 (progress_bar.py:262, log())
[2021-04-10 00:55:06]    INFO >> epoch 024:   1761 / 1881 loss=0.873, mrr=801.469, sample_size=1000, wps=6316.5, ups=6.32, wpb=1000, bsz=1000, num_updates=45000, lr=0.01, gnorm=0.055, clip=0, train_wall=74, wall=7065 (progress_bar.py:262, log())
[2021-04-10 00:55:27]    INFO >> epoch 024 | loss 0.871 | mrr 0.805247 | sample_size 1000 | wps 6167.6 | ups 6.17 | wpb 1000 | bsz 1000 | num_updates 45120 | lr 0.01 | gnorm 0.054 | clip 0 | train_wall 261 | wall 7086 (progress_bar.py:269, print())
[2021-04-10 00:55:43]    INFO >> epoch 024 | valid on 'valid' subset | loss 0.953 | mrr 0.662342 | sample_size 1000 | wps 11111.2 | wpb 1000 | bsz 1000 | num_updates 45120 | best_mrr 662.342 (progress_bar.py:269, print())
[2021-04-10 00:55:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 24 @ 45120 updates, score 0.662342) (writing took 0.469301 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:56:49]    INFO >> epoch 025:    380 / 1881 loss=0.868, mrr=809.239, sample_size=1000, wps=4884.7, ups=4.88, wpb=1000, bsz=1000, num_updates=45500, lr=0.01, gnorm=0.055, clip=0, train_wall=76, wall=7167 (progress_bar.py:262, log())
[2021-04-10 00:58:05]    INFO >> epoch 025:    881 / 1881 loss=0.869, mrr=808.656, sample_size=1000, wps=6544.4, ups=6.54, wpb=1000, bsz=1000, num_updates=46000, lr=0.01, gnorm=0.055, clip=0, train_wall=71, wall=7244 (progress_bar.py:262, log())
[2021-04-10 00:59:19]    INFO >> epoch 025:   1381 / 1881 loss=0.872, mrr=803.98, sample_size=1000, wps=6772.7, ups=6.77, wpb=1000, bsz=1000, num_updates=46500, lr=0.01, gnorm=0.055, clip=0, train_wall=69, wall=7318 (progress_bar.py:262, log())
[2021-04-10 01:00:39]    INFO >> epoch 025:   1881 / 1881 loss=0.874, mrr=800.902, sample_size=1000, wps=6266.2, ups=6.27, wpb=1000, bsz=1000, num_updates=47000, lr=0.01, gnorm=0.055, clip=0, train_wall=75, wall=7398 (progress_bar.py:262, log())
[2021-04-10 01:00:39]    INFO >> epoch 025 | loss 0.87 | mrr 0.806058 | sample_size 1000 | wps 6024.2 | ups 6.02 | wpb 1000 | bsz 1000 | num_updates 47000 | lr 0.01 | gnorm 0.055 | clip 0 | train_wall 271 | wall 7398 (progress_bar.py:269, print())
[2021-04-10 01:00:56]    INFO >> epoch 025 | valid on 'valid' subset | loss 0.953 | mrr 0.66305 | sample_size 1000 | wps 11268.2 | wpb 1000 | bsz 1000 | num_updates 47000 | best_mrr 663.05 (progress_bar.py:269, print())
[2021-04-10 01:00:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 25 @ 47000 updates, score 0.66305) (writing took 0.488260 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:02:21]    INFO >> epoch 026:    501 / 1881 loss=0.866, mrr=811.452, sample_size=1000, wps=4889, ups=4.89, wpb=1000, bsz=1000, num_updates=47500, lr=0.01, gnorm=0.055, clip=0, train_wall=75, wall=7500 (progress_bar.py:262, log())
[2021-04-10 01:03:41]    INFO >> epoch 026:   1001 / 1881 loss=0.869, mrr=807.483, sample_size=1000, wps=6242.2, ups=6.24, wpb=1000, bsz=1000, num_updates=48000, lr=0.01, gnorm=0.056, clip=0, train_wall=75, wall=7580 (progress_bar.py:262, log())
[2021-04-10 01:05:02]    INFO >> epoch 026:   1501 / 1881 loss=0.871, mrr=804.695, sample_size=1000, wps=6217.8, ups=6.22, wpb=1000, bsz=1000, num_updates=48500, lr=0.01, gnorm=0.056, clip=0, train_wall=76, wall=7660 (progress_bar.py:262, log())
[2021-04-10 01:06:02]    INFO >> epoch 026 | loss 0.87 | mrr 0.806411 | sample_size 1000 | wps 5831.1 | ups 5.83 | wpb 1000 | bsz 1000 | num_updates 48880 | lr 0.01 | gnorm 0.056 | clip 0 | train_wall 282 | wall 7720 (progress_bar.py:269, print())
[2021-04-10 01:06:17]    INFO >> epoch 026 | valid on 'valid' subset | loss 0.954 | mrr 0.661997 | sample_size 1000 | wps 11808.9 | wpb 1000 | bsz 1000 | num_updates 48880 | best_mrr 661.997 (progress_bar.py:269, print())
[2021-04-10 01:06:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 26 @ 48880 updates, score 0.661997) (writing took 0.457804 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:06:42]    INFO >> epoch 027:    120 / 1881 loss=0.871, mrr=804.302, sample_size=1000, wps=5003.6, ups=5, wpb=1000, bsz=1000, num_updates=49000, lr=0.01, gnorm=0.056, clip=0, train_wall=73, wall=7760 (progress_bar.py:262, log())
[2021-04-10 01:08:02]    INFO >> epoch 027:    620 / 1881 loss=0.867, mrr=810.723, sample_size=1000, wps=6239.9, ups=6.24, wpb=1000, bsz=1000, num_updates=49500, lr=0.01, gnorm=0.056, clip=0, train_wall=75, wall=7840 (progress_bar.py:262, log())
[2021-04-10 01:09:17]    INFO >> epoch 027:   1120 / 1881 loss=0.87, mrr=806.464, sample_size=1000, wps=6653.7, ups=6.65, wpb=1000, bsz=1000, num_updates=50000, lr=0.01, gnorm=0.056, clip=0, train_wall=70, wall=7916 (progress_bar.py:262, log())
[2021-04-10 01:10:31]    INFO >> epoch 027:   1621 / 1881 loss=0.872, mrr=803.479, sample_size=1000, wps=6755.3, ups=6.76, wpb=1000, bsz=1000, num_updates=50500, lr=0.01, gnorm=0.056, clip=0, train_wall=68, wall=7990 (progress_bar.py:262, log())
[2021-04-10 01:11:14]    INFO >> epoch 027 | loss 0.87 | mrr 0.806706 | sample_size 1000 | wps 6023.1 | ups 6.02 | wpb 1000 | bsz 1000 | num_updates 50760 | lr 0.01 | gnorm 0.056 | clip 0 | train_wall 271 | wall 8032 (progress_bar.py:269, print())
[2021-04-10 01:11:29]    INFO >> epoch 027 | valid on 'valid' subset | loss 0.953 | mrr 0.662288 | sample_size 1000 | wps 11605.6 | wpb 1000 | bsz 1000 | num_updates 50760 | best_mrr 662.288 (progress_bar.py:269, print())
[2021-04-10 01:11:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 27 @ 50760 updates, score 0.662288) (writing took 0.433552 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:12:15]    INFO >> epoch 028:    240 / 1881 loss=0.869, mrr=807.95, sample_size=1000, wps=4824.8, ups=4.82, wpb=1000, bsz=1000, num_updates=51000, lr=0.01, gnorm=0.057, clip=0, train_wall=76, wall=8093 (progress_bar.py:262, log())
[2021-04-10 01:13:32]    INFO >> epoch 028:    740 / 1881 loss=0.867, mrr=810.722, sample_size=1000, wps=6422.4, ups=6.42, wpb=1000, bsz=1000, num_updates=51500, lr=0.01, gnorm=0.057, clip=0, train_wall=73, wall=8171 (progress_bar.py:262, log())
[2021-04-10 01:14:53]    INFO >> epoch 028:   1241 / 1881 loss=0.87, mrr=805.688, sample_size=1000, wps=6231.1, ups=6.23, wpb=1000, bsz=1000, num_updates=52000, lr=0.01, gnorm=0.057, clip=0, train_wall=75, wall=8251 (progress_bar.py:262, log())
[2021-04-10 01:16:13]    INFO >> epoch 028:   1741 / 1881 loss=0.872, mrr=803.413, sample_size=1000, wps=6208, ups=6.21, wpb=1000, bsz=1000, num_updates=52500, lr=0.01, gnorm=0.057, clip=0, train_wall=76, wall=8332 (progress_bar.py:262, log())
[2021-04-10 01:16:35]    INFO >> epoch 028 | loss 0.869 | mrr 0.80725 | sample_size 1000 | wps 5841.8 | ups 5.84 | wpb 1000 | bsz 1000 | num_updates 52640 | lr 0.01 | gnorm 0.057 | clip 0 | train_wall 281 | wall 8354 (progress_bar.py:269, print())
[2021-04-10 01:16:52]    INFO >> epoch 028 | valid on 'valid' subset | loss 0.953 | mrr 0.662352 | sample_size 1000 | wps 11119 | wpb 1000 | bsz 1000 | num_updates 52640 | best_mrr 662.352 (progress_bar.py:269, print())
[2021-04-10 01:16:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 28 @ 52640 updates, score 0.662352) (writing took 0.493944 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:17:56]    INFO >> epoch 029:    360 / 1881 loss=0.867, mrr=810.433, sample_size=1000, wps=4883.5, ups=4.88, wpb=1000, bsz=1000, num_updates=53000, lr=0.01, gnorm=0.057, clip=0, train_wall=75, wall=8434 (progress_bar.py:262, log())
[2021-04-10 01:19:15]    INFO >> epoch 029:    860 / 1881 loss=0.868, mrr=809.282, sample_size=1000, wps=6272.6, ups=6.27, wpb=1000, bsz=1000, num_updates=53500, lr=0.01, gnorm=0.058, clip=0, train_wall=75, wall=8514 (progress_bar.py:262, log())
[2021-04-10 01:20:35]    INFO >> epoch 029:   1361 / 1881 loss=0.87, mrr=805.863, sample_size=1000, wps=6251.1, ups=6.25, wpb=1000, bsz=1000, num_updates=54000, lr=0.01, gnorm=0.058, clip=0, train_wall=75, wall=8594 (progress_bar.py:262, log())
[2021-04-10 01:21:55]    INFO >> epoch 029:   1861 / 1881 loss=0.872, mrr=803.203, sample_size=1000, wps=6258.4, ups=6.26, wpb=1000, bsz=1000, num_updates=54500, lr=0.01, gnorm=0.058, clip=0, train_wall=75, wall=8674 (progress_bar.py:262, log())
[2021-04-10 01:21:59]    INFO >> epoch 029 | loss 0.869 | mrr 0.807594 | sample_size 1000 | wps 5817.8 | ups 5.82 | wpb 1000 | bsz 1000 | num_updates 54520 | lr 0.01 | gnorm 0.058 | clip 0 | train_wall 282 | wall 8677 (progress_bar.py:269, print())
[2021-04-10 01:22:14]    INFO >> epoch 029 | valid on 'valid' subset | loss 0.954 | mrr 0.661228 | sample_size 1000 | wps 11591.2 | wpb 1000 | bsz 1000 | num_updates 54520 | best_mrr 661.228 (progress_bar.py:269, print())
[2021-04-10 01:22:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 29 @ 54520 updates, score 0.661228) (writing took 0.445517 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:23:37]    INFO >> epoch 030:    481 / 1881 loss=0.866, mrr=811.327, sample_size=1000, wps=4909.4, ups=4.91, wpb=1000, bsz=1000, num_updates=55000, lr=0.01, gnorm=0.058, clip=0, train_wall=75, wall=8776 (progress_bar.py:262, log())
[2021-04-10 01:24:55]    INFO >> epoch 030:    981 / 1881 loss=0.868, mrr=809.303, sample_size=1000, wps=6378.4, ups=6.38, wpb=1000, bsz=1000, num_updates=55500, lr=0.01, gnorm=0.058, clip=0, train_wall=74, wall=8854 (progress_bar.py:262, log())
[2021-04-10 01:26:09]    INFO >> epoch 030:   1481 / 1881 loss=0.87, mrr=806.15, sample_size=1000, wps=6841.2, ups=6.84, wpb=1000, bsz=1000, num_updates=56000, lr=0.01, gnorm=0.058, clip=0, train_wall=66, wall=8927 (progress_bar.py:262, log())
[2021-04-10 01:27:03]    INFO >> epoch 030 | loss 0.869 | mrr 0.80772 | sample_size 1000 | wps 6185.8 | ups 6.19 | wpb 1000 | bsz 1000 | num_updates 56400 | lr 0.01 | gnorm 0.058 | clip 0 | train_wall 261 | wall 8981 (progress_bar.py:269, print())
[2021-04-10 01:27:15]    INFO >> epoch 030 | valid on 'valid' subset | loss 0.953 | mrr 0.662938 | sample_size 1000 | wps 11198.8 | wpb 1000 | bsz 1000 | num_updates 56400 | best_mrr 662.938 (progress_bar.py:269, print())
[2021-04-10 01:27:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/nbow/checkpoints/checkpoint_last.pt (epoch 30 @ 56400 updates, score 0.662938) (writing took 0.481198 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:27:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-10 01:27:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-10 01:27:15]    INFO >> done training in 8964.0 seconds (train.py:283, single_main())
