nohup: 忽略输入
[2021-04-09 23:05:20]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn/all.yml (train.py:302, cli_main())
[2021-04-09 23:05:20]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go', 'java', 'javascript', 'ruby', 'python', 'php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': 1000}} (train.py:304, cli_main())
[2021-04-09 23:05:20]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-09 23:05:20]    INFO >> loaded 89154 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.go.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.java.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.javascript.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.ruby.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.python.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-09 23:05:20]    INFO >> loaded 89154 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.go.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.java.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.javascript.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.ruby.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.python.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-09 23:05:21]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (go): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (java): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (javascript): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (ruby): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (python): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (php): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-09 23:05:21]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-09 23:05:21]    INFO >> num. model params: 10351488 (num. trained: 10351488) (train.py:227, single_main())
[2021-04-09 23:05:25]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-09 23:05:25]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-09 23:05:25]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-09 23:05:25]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-09 23:05:26]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.code_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-09 23:05:26]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.docstring_tokens', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-09 23:05:26]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.code_tokens.wo_func', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-09 23:05:26]    INFO >> loaded 1880853 examples from: ['/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.go.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.java.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.javascript.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.ruby.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.python.func_name', '/data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-09 23:05:29]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-09 23:12:48]    INFO >> epoch 001:    500 / 1881 loss=5.068, mrr=156.728, sample_size=1000, wps=1153.1, ups=1.15, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.256, clip=0.6, train_wall=429, wall=443 (progress_bar.py:262, log())
[2021-04-09 23:20:07]    INFO >> epoch 001:   1000 / 1881 loss=3.315, mrr=425.265, sample_size=1000, wps=1138.5, ups=1.14, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.204, clip=0, train_wall=434, wall=882 (progress_bar.py:262, log())
[2021-04-09 23:27:31]    INFO >> epoch 001:   1500 / 1881 loss=2.818, mrr=513.62, sample_size=1000, wps=1126, ups=1.13, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.201, clip=0, train_wall=439, wall=1326 (progress_bar.py:262, log())
[2021-04-09 23:33:04]    INFO >> epoch 001 | loss 3.502 | mrr 0.403245 | sample_size 1000 | wps 1139.2 | ups 1.14 | wpb 1000 | bsz 1000 | num_updates 1880 | lr 0.01 | gnorm 0.215 | clip 0.2 | train_wall 1631 | wall 1659 (progress_bar.py:269, print())
[2021-04-09 23:33:34]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.293 | mrr 0.449603 | sample_size 1000 | wps 4197.1 | wpb 1000 | bsz 1000 | num_updates 1880 (progress_bar.py:269, print())
[2021-04-09 23:33:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 1880 updates, score 0.449603) (writing took 0.815295 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-09 23:35:27]    INFO >> epoch 002:    120 / 1881 loss=2.558, mrr=558.09, sample_size=1000, wps=1050.5, ups=1.05, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.197, clip=0, train_wall=435, wall=1802 (progress_bar.py:262, log())
[2021-04-09 23:42:50]    INFO >> epoch 002:    620 / 1881 loss=2.391, mrr=586.956, sample_size=1000, wps=1129.5, ups=1.13, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.197, clip=0, train_wall=438, wall=2245 (progress_bar.py:262, log())
[2021-04-09 23:50:10]    INFO >> epoch 002:   1121 / 1881 loss=2.311, mrr=601.181, sample_size=1000, wps=1134.3, ups=1.13, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.196, clip=0, train_wall=436, wall=2685 (progress_bar.py:262, log())
[2021-04-09 23:57:34]    INFO >> epoch 002:   1621 / 1881 loss=2.25, mrr=611.013, sample_size=1000, wps=1127.7, ups=1.13, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.196, clip=0, train_wall=438, wall=3129 (progress_bar.py:262, log())
[2021-04-10 00:01:25]    INFO >> epoch 002 | loss 2.31 | mrr 0.600796 | sample_size 1000 | wps 1105.4 | ups 1.11 | wpb 1000 | bsz 1000 | num_updates 3760 | lr 0.01 | gnorm 0.197 | clip 0 | train_wall 1645 | wall 3360 (progress_bar.py:269, print())
[2021-04-10 00:01:54]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.891 | mrr 0.515253 | sample_size 1000 | wps 4222.8 | wpb 1000 | bsz 1000 | num_updates 3760 | best_mrr 515.253 (progress_bar.py:269, print())
[2021-04-10 00:01:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 3760 updates, score 0.515253) (writing took 0.902106 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:05:31]    INFO >> epoch 003:    240 / 1881 loss=2.168, mrr=625.044, sample_size=1000, wps=1047.2, ups=1.05, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.197, clip=0, train_wall=436, wall=3606 (progress_bar.py:262, log())
[2021-04-10 00:12:55]    INFO >> epoch 003:    740 / 1881 loss=2.13, mrr=631.977, sample_size=1000, wps=1127.3, ups=1.13, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.199, clip=0, train_wall=439, wall=4050 (progress_bar.py:262, log())
[2021-04-10 00:20:15]    INFO >> epoch 003:   1240 / 1881 loss=2.107, mrr=635.933, sample_size=1000, wps=1136.8, ups=1.14, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.214, clip=0.2, train_wall=435, wall=4490 (progress_bar.py:262, log())
[2021-04-10 00:27:38]    INFO >> epoch 003:   1741 / 1881 loss=2.096, mrr=638.161, sample_size=1000, wps=1127, ups=1.13, wpb=1000, bsz=1000, num_updates=5500, lr=0.01, gnorm=0.202, clip=0, train_wall=439, wall=4933 (progress_bar.py:262, log())
[2021-04-10 00:29:42]    INFO >> epoch 003 | loss 2.111 | mrr 0.635278 | sample_size 1000 | wps 1107.9 | ups 1.11 | wpb 1000 | bsz 1000 | num_updates 5640 | lr 0.01 | gnorm 0.203 | clip 0.1 | train_wall 1642 | wall 5057 (progress_bar.py:269, print())
[2021-04-10 00:30:07]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.757 | mrr 0.53827 | sample_size 1000 | wps 4282.7 | wpb 1000 | bsz 1000 | num_updates 5640 | best_mrr 538.27 (progress_bar.py:269, print())
[2021-04-10 00:30:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 5640 updates, score 0.53827) (writing took 7.525794 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 00:35:44]    INFO >> epoch 004:    360 / 1881 loss=2.046, mrr=646.415, sample_size=1000, wps=1029.3, ups=1.03, wpb=1000, bsz=1000, num_updates=6000, lr=0.01, gnorm=0.202, clip=0, train_wall=438, wall=5419 (progress_bar.py:262, log())
[2021-04-10 00:43:04]    INFO >> epoch 004:    861 / 1881 loss=2.036, mrr=648.628, sample_size=1000, wps=1136.1, ups=1.14, wpb=1000, bsz=1000, num_updates=6500, lr=0.01, gnorm=0.204, clip=0, train_wall=435, wall=5859 (progress_bar.py:262, log())
[2021-04-10 00:50:27]    INFO >> epoch 004:   1361 / 1881 loss=2.025, mrr=650.372, sample_size=1000, wps=1128.2, ups=1.13, wpb=1000, bsz=1000, num_updates=7000, lr=0.01, gnorm=0.204, clip=0, train_wall=438, wall=6302 (progress_bar.py:262, log())
[2021-04-10 00:57:39]    INFO >> epoch 004:   1861 / 1881 loss=2.032, mrr=649.603, sample_size=1000, wps=1157.6, ups=1.16, wpb=1000, bsz=1000, num_updates=7500, lr=0.01, gnorm=0.216, clip=0.2, train_wall=427, wall=6734 (progress_bar.py:262, log())
[2021-04-10 00:57:57]    INFO >> epoch 004 | loss 2.031 | mrr 0.6493 | sample_size 1000 | wps 1108.9 | ups 1.11 | wpb 1000 | bsz 1000 | num_updates 7520 | lr 0.01 | gnorm 0.207 | clip 0.1 | train_wall 1634 | wall 6752 (progress_bar.py:269, print())
[2021-04-10 00:58:28]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.695 | mrr 0.547139 | sample_size 1000 | wps 4085.7 | wpb 1000 | bsz 1000 | num_updates 7520 | best_mrr 547.139 (progress_bar.py:269, print())
[2021-04-10 00:58:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 7520 updates, score 0.547139) (writing took 0.840196 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:05:41]    INFO >> epoch 005:    481 / 1881 loss=1.993, mrr=655.778, sample_size=1000, wps=1036.9, ups=1.04, wpb=1000, bsz=1000, num_updates=8000, lr=0.01, gnorm=0.209, clip=0, train_wall=440, wall=7217 (progress_bar.py:262, log())
[2021-04-10 01:13:01]    INFO >> epoch 005:    981 / 1881 loss=1.999, mrr=655.375, sample_size=1000, wps=1137.1, ups=1.14, wpb=1000, bsz=1000, num_updates=8500, lr=0.01, gnorm=0.21, clip=0, train_wall=435, wall=7656 (progress_bar.py:262, log())
[2021-04-10 01:20:27]    INFO >> epoch 005:   1481 / 1881 loss=1.994, mrr=656.376, sample_size=1000, wps=1122.4, ups=1.12, wpb=1000, bsz=1000, num_updates=9000, lr=0.01, gnorm=0.208, clip=0, train_wall=441, wall=8102 (progress_bar.py:262, log())
[2021-04-10 01:26:19]    INFO >> epoch 005 | loss 1.995 | mrr 0.655859 | sample_size 1000 | wps 1105 | ups 1.1 | wpb 1000 | bsz 1000 | num_updates 9400 | lr 0.01 | gnorm 0.209 | clip 0 | train_wall 1645 | wall 8454 (progress_bar.py:269, print())
[2021-04-10 01:26:44]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.654 | mrr 0.553538 | sample_size 1000 | wps 4225.4 | wpb 1000 | bsz 1000 | num_updates 9400 | best_mrr 553.538 (progress_bar.py:269, print())
[2021-04-10 01:26:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 9400 updates, score 0.553538) (writing took 0.879065 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:28:18]    INFO >> epoch 006:    100 / 1881 loss=1.988, mrr=657.366, sample_size=1000, wps=1060.6, ups=1.06, wpb=1000, bsz=1000, num_updates=9500, lr=0.01, gnorm=0.212, clip=0.2, train_wall=430, wall=8573 (progress_bar.py:262, log())
[2021-04-10 01:35:10]    INFO >> epoch 006:    600 / 1881 loss=1.973, mrr=659.011, sample_size=1000, wps=1212.4, ups=1.21, wpb=1000, bsz=1000, num_updates=10000, lr=0.01, gnorm=0.215, clip=0, train_wall=408, wall=8986 (progress_bar.py:262, log())
[2021-04-10 01:42:00]    INFO >> epoch 006:   1101 / 1881 loss=1.979, mrr=658.237, sample_size=1000, wps=1221.6, ups=1.22, wpb=1000, bsz=1000, num_updates=10500, lr=0.01, gnorm=0.222, clip=0.2, train_wall=405, wall=9395 (progress_bar.py:262, log())
[2021-04-10 01:48:51]    INFO >> epoch 006:   1601 / 1881 loss=1.989, mrr=656.736, sample_size=1000, wps=1214.9, ups=1.21, wpb=1000, bsz=1000, num_updates=11000, lr=0.01, gnorm=0.23, clip=0.2, train_wall=407, wall=9806 (progress_bar.py:262, log())
[2021-04-10 01:52:43]    INFO >> epoch 006 | loss 1.979 | mrr 0.658342 | sample_size 1000 | wps 1186.7 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 11280 | lr 0.01 | gnorm 0.222 | clip 0.2 | train_wall 1532 | wall 10038 (progress_bar.py:269, print())
[2021-04-10 01:53:09]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.648 | mrr 0.554473 | sample_size 1000 | wps 4730 | wpb 1000 | bsz 1000 | num_updates 11280 | best_mrr 554.473 (progress_bar.py:269, print())
[2021-04-10 01:53:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 11280 updates, score 0.554473) (writing took 0.816746 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 01:56:17]    INFO >> epoch 007:    220 / 1881 loss=1.971, mrr=660.244, sample_size=1000, wps=1121.7, ups=1.12, wpb=1000, bsz=1000, num_updates=11500, lr=0.01, gnorm=0.219, clip=0.2, train_wall=409, wall=10252 (progress_bar.py:262, log())
[2021-04-10 02:03:04]    INFO >> epoch 007:    721 / 1881 loss=1.957, mrr=662.225, sample_size=1000, wps=1229, ups=1.23, wpb=1000, bsz=1000, num_updates=12000, lr=0.01, gnorm=0.223, clip=0, train_wall=403, wall=10659 (progress_bar.py:262, log())
[2021-04-10 02:09:54]    INFO >> epoch 007:   1221 / 1881 loss=1.974, mrr=659.932, sample_size=1000, wps=1218.7, ups=1.22, wpb=1000, bsz=1000, num_updates=12500, lr=0.01, gnorm=0.224, clip=0, train_wall=406, wall=11069 (progress_bar.py:262, log())
[2021-04-10 02:16:41]    INFO >> epoch 007:   1721 / 1881 loss=1.98, mrr=659.295, sample_size=1000, wps=1228, ups=1.23, wpb=1000, bsz=1000, num_updates=13000, lr=0.01, gnorm=0.229, clip=0, train_wall=403, wall=11476 (progress_bar.py:262, log())
[2021-04-10 02:18:53]    INFO >> epoch 007 | loss 1.969 | mrr 0.660681 | sample_size 1000 | wps 1197.3 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 13160 | lr 0.01 | gnorm 0.225 | clip 0 | train_wall 1522 | wall 11608 (progress_bar.py:269, print())
[2021-04-10 02:19:19]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.625 | mrr 0.55804 | sample_size 1000 | wps 4771.1 | wpb 1000 | bsz 1000 | num_updates 13160 | best_mrr 558.04 (progress_bar.py:269, print())
[2021-04-10 02:19:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 13160 updates, score 0.55804) (writing took 0.888129 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 02:24:06]    INFO >> epoch 008:    340 / 1881 loss=1.963, mrr=661.873, sample_size=1000, wps=1125.6, ups=1.13, wpb=1000, bsz=1000, num_updates=13500, lr=0.01, gnorm=0.23, clip=0, train_wall=408, wall=11921 (progress_bar.py:262, log())
[2021-04-10 02:30:52]    INFO >> epoch 008:    840 / 1881 loss=1.964, mrr=661.119, sample_size=1000, wps=1229.1, ups=1.23, wpb=1000, bsz=1000, num_updates=14000, lr=0.01, gnorm=0.237, clip=0.2, train_wall=403, wall=12328 (progress_bar.py:262, log())
[2021-04-10 02:37:37]    INFO >> epoch 008:   1341 / 1881 loss=1.988, mrr=657.485, sample_size=1000, wps=1235.6, ups=1.24, wpb=1000, bsz=1000, num_updates=14500, lr=0.01, gnorm=0.266, clip=0.8, train_wall=401, wall=12732 (progress_bar.py:262, log())
[2021-04-10 02:44:24]    INFO >> epoch 008:   1841 / 1881 loss=1.994, mrr=656.945, sample_size=1000, wps=1228.5, ups=1.23, wpb=1000, bsz=1000, num_updates=15000, lr=0.01, gnorm=0.314, clip=2.4, train_wall=403, wall=13139 (progress_bar.py:262, log())
[2021-04-10 02:44:58]    INFO >> epoch 008 | loss 1.978 | mrr 0.659168 | sample_size 1000 | wps 1201.4 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 15040 | lr 0.01 | gnorm 0.339 | clip 1.3 | train_wall 1517 | wall 13173 (progress_bar.py:269, print())
[2021-04-10 02:45:24]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.643 | mrr 0.556198 | sample_size 1000 | wps 4828.5 | wpb 1000 | bsz 1000 | num_updates 15040 | best_mrr 556.198 (progress_bar.py:269, print())
[2021-04-10 02:45:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 8 @ 15040 updates, score 0.556198) (writing took 0.445179 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 02:51:47]    INFO >> epoch 009:    461 / 1881 loss=2.026, mrr=651.241, sample_size=1000, wps=1128.1, ups=1.13, wpb=1000, bsz=1000, num_updates=15500, lr=0.01, gnorm=1.573, clip=7, train_wall=407, wall=13582 (progress_bar.py:262, log())
[2021-04-10 02:58:39]    INFO >> epoch 009:    961 / 1881 loss=2.03, mrr=650.555, sample_size=1000, wps=1213.2, ups=1.21, wpb=1000, bsz=1000, num_updates=16000, lr=0.01, gnorm=0.44, clip=5, train_wall=408, wall=13995 (progress_bar.py:262, log())
[2021-04-10 03:05:28]    INFO >> epoch 009:   1461 / 1881 loss=2.026, mrr=651.369, sample_size=1000, wps=1222.7, ups=1.22, wpb=1000, bsz=1000, num_updates=16500, lr=0.01, gnorm=0.312, clip=1, train_wall=405, wall=14403 (progress_bar.py:262, log())
[2021-04-10 03:11:15]    INFO >> epoch 009 | loss 2.028 | mrr 0.651121 | sample_size 1000 | wps 1192.1 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 16920 | lr 0.01 | gnorm 0.604 | clip 3.3 | train_wall 1530 | wall 14750 (progress_bar.py:269, print())
[2021-04-10 03:11:42]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.637 | mrr 0.556488 | sample_size 1000 | wps 4658.2 | wpb 1000 | bsz 1000 | num_updates 16920 | best_mrr 556.488 (progress_bar.py:269, print())
[2021-04-10 03:11:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 9 @ 16920 updates, score 0.556488) (writing took 0.526264 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 03:12:54]    INFO >> epoch 010:     80 / 1881 loss=2.024, mrr=652.3, sample_size=1000, wps=1122.3, ups=1.12, wpb=1000, bsz=1000, num_updates=17000, lr=0.01, gnorm=0.308, clip=1.6, train_wall=409, wall=14849 (progress_bar.py:262, log())
[2021-04-10 03:19:41]    INFO >> epoch 010:    581 / 1881 loss=2.017, mrr=653.054, sample_size=1000, wps=1228.5, ups=1.23, wpb=1000, bsz=1000, num_updates=17500, lr=0.01, gnorm=0.327, clip=2.6, train_wall=403, wall=15256 (progress_bar.py:262, log())
[2021-04-10 03:26:33]    INFO >> epoch 010:   1081 / 1881 loss=2.022, mrr=651.951, sample_size=1000, wps=1214.2, ups=1.21, wpb=1000, bsz=1000, num_updates=18000, lr=0.01, gnorm=0.333, clip=1.6, train_wall=408, wall=15668 (progress_bar.py:262, log())
[2021-04-10 03:33:21]    INFO >> epoch 010:   1581 / 1881 loss=2.042, mrr=648.656, sample_size=1000, wps=1224.6, ups=1.22, wpb=1000, bsz=1000, num_updates=18500, lr=0.01, gnorm=0.341, clip=2.6, train_wall=404, wall=16076 (progress_bar.py:262, log())
[2021-04-10 03:37:27]    INFO >> epoch 010 | loss 2.029 | mrr 0.651001 | sample_size 1000 | wps 1195.8 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 18800 | lr 0.01 | gnorm 0.339 | clip 2.4 | train_wall 1524 | wall 16322 (progress_bar.py:269, print())
[2021-04-10 03:37:54]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.681 | mrr 0.549088 | sample_size 1000 | wps 4819.8 | wpb 1000 | bsz 1000 | num_updates 18800 | best_mrr 549.088 (progress_bar.py:269, print())
[2021-04-10 03:37:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 10 @ 18800 updates, score 0.549088) (writing took 0.460684 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 03:40:44]    INFO >> epoch 011:    200 / 1881 loss=2.038, mrr=649.489, sample_size=1000, wps=1128.3, ups=1.13, wpb=1000, bsz=1000, num_updates=19000, lr=0.01, gnorm=0.329, clip=1.8, train_wall=407, wall=16519 (progress_bar.py:262, log())
[2021-04-10 03:47:32]    INFO >> epoch 011:    700 / 1881 loss=2.023, mrr=651.73, sample_size=1000, wps=1227, ups=1.23, wpb=1000, bsz=1000, num_updates=19500, lr=0.01, gnorm=0.303, clip=0.8, train_wall=403, wall=16927 (progress_bar.py:262, log())
[2021-04-10 03:54:23]    INFO >> epoch 011:   1200 / 1881 loss=2.039, mrr=649.665, sample_size=1000, wps=1214.4, ups=1.21, wpb=1000, bsz=1000, num_updates=20000, lr=0.01, gnorm=0.329, clip=1.6, train_wall=408, wall=17338 (progress_bar.py:262, log())
[2021-04-10 04:01:15]    INFO >> epoch 011:   1701 / 1881 loss=2.085, mrr=641.757, sample_size=1000, wps=1213.4, ups=1.21, wpb=1000, bsz=1000, num_updates=20500, lr=0.01, gnorm=68.97, clip=38.6, train_wall=408, wall=17750 (progress_bar.py:262, log())
[2021-04-10 04:03:40]    INFO >> epoch 011 | loss 2.068 | mrr 0.644452 | sample_size 1000 | wps 1195 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 20680 | lr 0.01 | gnorm 27.44 | clip 19.7 | train_wall 1525 | wall 17896 (progress_bar.py:269, print())
[2021-04-10 04:04:07]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.866 | mrr 0.520537 | sample_size 1000 | wps 4770.9 | wpb 1000 | bsz 1000 | num_updates 20680 | best_mrr 520.537 (progress_bar.py:269, print())
[2021-04-10 04:04:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 11 @ 20680 updates, score 0.520537) (writing took 0.453306 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 04:08:34]    INFO >> epoch 012:    320 / 1881 loss=2.302, mrr=605.707, sample_size=1000, wps=1140.1, ups=1.14, wpb=1000, bsz=1000, num_updates=21000, lr=0.01, gnorm=2924.57, clip=92.8, train_wall=402, wall=18189 (progress_bar.py:262, log())
[2021-04-10 04:15:23]    INFO >> epoch 012:    820 / 1881 loss=2.301, mrr=605.399, sample_size=1000, wps=1222.7, ups=1.22, wpb=1000, bsz=1000, num_updates=21500, lr=0.01, gnorm=2287.17, clip=90.6, train_wall=405, wall=18598 (progress_bar.py:262, log())
[2021-04-10 04:22:12]    INFO >> epoch 012:   1321 / 1881 loss=2.316, mrr=603.29, sample_size=1000, wps=1223.2, ups=1.22, wpb=1000, bsz=1000, num_updates=22000, lr=0.01, gnorm=10485.9, clip=98.6, train_wall=405, wall=19007 (progress_bar.py:262, log())
[2021-04-10 04:29:04]    INFO >> epoch 012:   1821 / 1881 loss=2.399, mrr=590.533, sample_size=1000, wps=1212.4, ups=1.21, wpb=1000, bsz=1000, num_updates=22500, lr=0.01, gnorm=21316.8, clip=100, train_wall=408, wall=19419 (progress_bar.py:262, log())
[2021-04-10 04:29:54]    INFO >> epoch 012 | loss 2.339 | mrr 0.599702 | sample_size 1000 | wps 1194.5 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 22560 | lr 0.01 | gnorm 11233.3 | clip 96 | train_wall 1525 | wall 19469 (progress_bar.py:269, print())
[2021-04-10 04:30:21]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.897 | mrr 0.517667 | sample_size 1000 | wps 4789.8 | wpb 1000 | bsz 1000 | num_updates 22560 | best_mrr 517.667 (progress_bar.py:269, print())
[2021-04-10 04:30:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 12 @ 22560 updates, score 0.517667) (writing took 0.435483 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 04:36:26]    INFO >> epoch 013:    440 / 1881 loss=2.555, mrr=568.945, sample_size=1000, wps=1131.1, ups=1.13, wpb=1000, bsz=1000, num_updates=23000, lr=0.01, gnorm=3.40925e+08, clip=100, train_wall=406, wall=19861 (progress_bar.py:262, log())
[2021-04-10 04:43:18]    INFO >> epoch 013:    940 / 1881 loss=2.715, mrr=550.202, sample_size=1000, wps=1214, ups=1.21, wpb=1000, bsz=1000, num_updates=23500, lr=0.01, gnorm=6.70633e+08, clip=100, train_wall=408, wall=20273 (progress_bar.py:262, log())
[2021-04-10 04:50:07]    INFO >> epoch 013:   1441 / 1881 loss=2.866, mrr=536.935, sample_size=1000, wps=1222.9, ups=1.22, wpb=1000, bsz=1000, num_updates=24000, lr=0.01, gnorm=3.37872e+11, clip=100, train_wall=405, wall=20682 (progress_bar.py:262, log())
[2021-04-10 04:56:10]    INFO >> epoch 013 | loss 2.755 | mrr 0.547408 | sample_size 1000 | wps 1193.3 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 24440 | lr 0.01 | gnorm 9.44011e+10 | clip 100 | train_wall 1528 | wall 21045 (progress_bar.py:269, print())
[2021-04-10 04:56:36]    INFO >> epoch 013 | valid on 'valid' subset | loss 3.113 | mrr 0.492414 | sample_size 1000 | wps 4855.9 | wpb 1000 | bsz 1000 | num_updates 24440 | best_mrr 492.414 (progress_bar.py:269, print())
[2021-04-10 04:56:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 13 @ 24440 updates, score 0.492414) (writing took 0.525097 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 04:57:32]    INFO >> epoch 014:     60 / 1881 loss=2.861, mrr=536.154, sample_size=1000, wps=1122.1, ups=1.12, wpb=1000, bsz=1000, num_updates=24500, lr=0.01, gnorm=1.75032e+10, clip=100, train_wall=408, wall=21128 (progress_bar.py:262, log())
[2021-04-10 05:04:21]    INFO >> epoch 014:    561 / 1881 loss=2.828, mrr=538.757, sample_size=1000, wps=1224.2, ups=1.22, wpb=1000, bsz=1000, num_updates=25000, lr=0.01, gnorm=1.28442e+11, clip=100, train_wall=404, wall=21536 (progress_bar.py:262, log())
[2021-04-10 05:11:13]    INFO >> epoch 014:   1061 / 1881 loss=2.854, mrr=536.215, sample_size=1000, wps=1212.6, ups=1.21, wpb=1000, bsz=1000, num_updates=25500, lr=0.01, gnorm=3.22093e+11, clip=100, train_wall=408, wall=21948 (progress_bar.py:262, log())
[2021-04-10 05:18:06]    INFO >> epoch 014:   1561 / 1881 loss=2.87, mrr=535.607, sample_size=1000, wps=1211.5, ups=1.21, wpb=1000, bsz=1000, num_updates=26000, lr=0.01, gnorm=7.59959e+12, clip=100, train_wall=409, wall=22361 (progress_bar.py:262, log())
[2021-04-10 05:22:26]    INFO >> epoch 014 | loss 2.865 | mrr 0.535931 | sample_size 1000 | wps 1192.7 | ups 1.19 | wpb 1000 | bsz 1000 | num_updates 26320 | lr 0.01 | gnorm 7.80612e+12 | clip 100 | train_wall 1528 | wall 22621 (progress_bar.py:269, print())
[2021-04-10 05:22:52]    INFO >> epoch 014 | valid on 'valid' subset | loss 3.204 | mrr 0.486835 | sample_size 1000 | wps 4774 | wpb 1000 | bsz 1000 | num_updates 26320 | best_mrr 486.835 (progress_bar.py:269, print())
[2021-04-10 05:22:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 14 @ 26320 updates, score 0.486835) (writing took 0.442797 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 05:25:25]    INFO >> epoch 015:    181 / 1881 loss=2.958, mrr=529.835, sample_size=1000, wps=1137.8, ups=1.14, wpb=1000, bsz=1000, num_updates=26500, lr=0.01, gnorm=2.64843e+13, clip=100, train_wall=403, wall=22800 (progress_bar.py:262, log())
[2021-04-10 05:32:19]    INFO >> epoch 015:    681 / 1881 loss=3.062, mrr=525.113, sample_size=1000, wps=1210.4, ups=1.21, wpb=1000, bsz=1000, num_updates=27000, lr=0.01, gnorm=6.61294e+11, clip=100, train_wall=409, wall=23214 (progress_bar.py:262, log())
[2021-04-10 05:39:08]    INFO >> epoch 015:   1181 / 1881 loss=3.12, mrr=521.286, sample_size=1000, wps=1222, ups=1.22, wpb=1000, bsz=1000, num_updates=27500, lr=0.01, gnorm=1.00201e+12, clip=100, train_wall=405, wall=23623 (progress_bar.py:262, log())
[2021-04-10 05:45:58]    INFO >> epoch 015:   1681 / 1881 loss=3.14, mrr=521.462, sample_size=1000, wps=1218.4, ups=1.22, wpb=1000, bsz=1000, num_updates=28000, lr=0.01, gnorm=1.11702e+14, clip=100, train_wall=406, wall=24033 (progress_bar.py:262, log())
[2021-04-10 05:48:38]    INFO >> epoch 015 | loss 3.103 | mrr 0.522814 | sample_size 1000 | wps 1196.3 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 28200 | lr 0.01 | gnorm 4.0846e+13 | clip 100 | train_wall 1524 | wall 24193 (progress_bar.py:269, print())
[2021-04-10 05:49:04]    INFO >> epoch 015 | valid on 'valid' subset | loss 3.347 | mrr 0.481501 | sample_size 1000 | wps 4772 | wpb 1000 | bsz 1000 | num_updates 28200 | best_mrr 481.501 (progress_bar.py:269, print())
[2021-04-10 05:49:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 15 @ 28200 updates, score 0.481501) (writing took 0.464371 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 05:53:12]    INFO >> epoch 016:    300 / 1881 loss=3.179, mrr=519.967, sample_size=1000, wps=1151, ups=1.15, wpb=1000, bsz=1000, num_updates=28500, lr=0.01, gnorm=7.52134e+13, clip=100, train_wall=398, wall=24468 (progress_bar.py:262, log())
[2021-04-10 06:00:04]    INFO >> epoch 016:    801 / 1881 loss=3.184, mrr=520.235, sample_size=1000, wps=1215.3, ups=1.22, wpb=1000, bsz=1000, num_updates=29000, lr=0.01, gnorm=2.12751e+12, clip=100, train_wall=407, wall=24879 (progress_bar.py:262, log())
[2021-04-10 06:06:49]    INFO >> epoch 016:   1301 / 1881 loss=3.201, mrr=519.417, sample_size=1000, wps=1234.5, ups=1.23, wpb=1000, bsz=1000, num_updates=29500, lr=0.01, gnorm=1.203e+12, clip=100, train_wall=401, wall=25284 (progress_bar.py:262, log())
[2021-04-10 06:13:37]    INFO >> epoch 016:   1801 / 1881 loss=3.207, mrr=518.445, sample_size=1000, wps=1224.2, ups=1.22, wpb=1000, bsz=1000, num_updates=30000, lr=0.01, gnorm=1.99229e+13, clip=100, train_wall=405, wall=25692 (progress_bar.py:262, log())
[2021-04-10 06:14:43]    INFO >> epoch 016 | loss 3.196 | mrr 0.519411 | sample_size 1000 | wps 1200.7 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 30080 | lr 0.01 | gnorm 1.6881e+13 | clip 100 | train_wall 1519 | wall 25758 (progress_bar.py:269, print())
[2021-04-10 06:15:10]    INFO >> epoch 016 | valid on 'valid' subset | loss 3.375 | mrr 0.480724 | sample_size 1000 | wps 4653.3 | wpb 1000 | bsz 1000 | num_updates 30080 | best_mrr 480.724 (progress_bar.py:269, print())
[2021-04-10 06:15:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 16 @ 30080 updates, score 0.480724) (writing took 0.454048 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 06:20:59]    INFO >> epoch 017:    420 / 1881 loss=3.218, mrr=518.902, sample_size=1000, wps=1131.9, ups=1.13, wpb=1000, bsz=1000, num_updates=30500, lr=0.01, gnorm=6.6807e+11, clip=100, train_wall=405, wall=26134 (progress_bar.py:262, log())
[2021-04-10 06:27:43]    INFO >> epoch 017:    921 / 1881 loss=3.176, mrr=518.761, sample_size=1000, wps=1239.1, ups=1.24, wpb=1000, bsz=1000, num_updates=31000, lr=0.01, gnorm=1.14131e+13, clip=100, train_wall=400, wall=26538 (progress_bar.py:262, log())
[2021-04-10 06:34:34]    INFO >> epoch 017:   1421 / 1881 loss=3.157, mrr=519.464, sample_size=1000, wps=1215.7, ups=1.22, wpb=1000, bsz=1000, num_updates=31500, lr=0.01, gnorm=1.6198e+11, clip=100, train_wall=407, wall=26949 (progress_bar.py:262, log())
[2021-04-10 06:40:48]    INFO >> epoch 017 | loss 3.176 | mrr 0.518975 | sample_size 1000 | wps 1201.4 | ups 1.2 | wpb 1000 | bsz 1000 | num_updates 31960 | lr 0.01 | gnorm 3.49839e+12 | clip 100 | train_wall 1517 | wall 27323 (progress_bar.py:269, print())
[2021-04-10 06:41:14]    INFO >> epoch 017 | valid on 'valid' subset | loss 3.34 | mrr 0.480672 | sample_size 1000 | wps 4822.6 | wpb 1000 | bsz 1000 | num_updates 31960 | best_mrr 480.672 (progress_bar.py:269, print())
[2021-04-10 06:41:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codesearchnet/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 17 @ 31960 updates, score 0.480672) (writing took 0.418121 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-10 06:41:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-10 06:41:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-10 06:41:15]    INFO >> done training in 27345.7 seconds (train.py:283, single_main())
