nohup: ignoring input
[2021-04-05 05:34:58]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/completion/gpt2/config/csn_feng/all.yml (train.py:291, cli_main())
[2021-04-05 05:34:58]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'multi_task_completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'truncate_target': 1}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap', 'target_lang': 'code_tokens', 'task_pipeline': ['python', 'ruby', 'go', 'php', 'java', 'javascript'], 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_mrr': 1}, 'model': {'arch': 'completion_gpt2', 'dropout': 0.5, 'decoder_embed_dim': 300, 'decoder_hidden_size': 300, 'decoder_layers': 6, 'decoder_attention_heads': 6, 'max_target_positions': 513, 'activation_fn': 'gelu', 'decoder_ffn_embed_dim': 1200}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints', 'restore_file': 'checkpoint_best.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'max_sentences_eval': 64}} (train.py:293, cli_main())
[2021-04-05 05:35:00]    INFO >> distributed init (rank 2): tcp://localhost:14241 (distributed_utils.py:84, distributed_init())
[2021-04-05 05:35:00]    INFO >> distributed init (rank 1): tcp://localhost:14241 (distributed_utils.py:84, distributed_init())
[2021-04-05 05:35:00]    INFO >> distributed init (rank 3): tcp://localhost:14241 (distributed_utils.py:84, distributed_init())
[2021-04-05 05:35:00]    INFO >> distributed init (rank 0): tcp://localhost:14241 (distributed_utils.py:84, distributed_init())
[2021-04-05 05:35:01]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 2 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-05 05:35:01]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 1 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-05 05:35:01]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 3 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-05 05:35:01]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 0 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-05 05:35:01]    INFO >> initialized host node14 as rank 0 (distributed_utils.py:93, distributed_init())
[2021-04-05 05:35:01]    INFO >> initialized host node14 as rank 3 (distributed_utils.py:93, distributed_init())
[2021-04-05 05:35:01]    INFO >> initialized host node14 as rank 2 (distributed_utils.py:93, distributed_init())
[2021-04-05 05:35:01]    INFO >> initialized host node14 as rank 1 (distributed_utils.py:93, distributed_init())
[2021-04-05 05:35:07]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'multi_task_completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'truncate_target': 1}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:14241', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap', 'target_lang': 'code_tokens', 'task_pipeline': ['python', 'ruby', 'go', 'php', 'java', 'javascript'], 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_mrr': 1}, 'model': {'arch': 'completion_gpt2', 'dropout': 0.5, 'decoder_embed_dim': 300, 'decoder_hidden_size': 300, 'decoder_layers': 6, 'decoder_attention_heads': 6, 'max_target_positions': 513, 'activation_fn': 'gelu', 'decoder_ffn_embed_dim': 1200}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints', 'restore_file': 'checkpoint_best.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'max_sentences_eval': 64}} (train.py:201, single_main())
[2021-04-05 05:35:07]    INFO >> [code_tokens] dictionary: 50000 types (multitask_completion.py:111, setup_task())
[2021-04-05 05:35:07]    INFO >> Truncate dataset into max length: 513 (multitask_completion.py:46, load_token_dataset())
[2021-04-05 05:35:07]    INFO >> loaded 44689 examples from: ['/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/python', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/go', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/php', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/java', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript'] (multitask_completion.py:47, load_token_dataset())
[2021-04-05 05:35:07]    INFO >> GPT2(
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(50000, 300, padding_idx=0)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (1): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (2): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (3): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (4): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (5): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
    )
    (out_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
  )
) (train.py:212, single_main())
[2021-04-05 05:35:07]    INFO >> model completion_gpt2, criterion CompletionCrossEntropyCriterion (train.py:213, single_main())
[2021-04-05 05:35:07]    INFO >> num. model params: 23076864 (num. trained: 23076864) (train.py:214, single_main())
[2021-04-05 05:35:08]    INFO >> training on 4 GPUs (train.py:221, single_main())
[2021-04-05 05:35:08]    INFO >> max tokens per GPU = 100000.0 and max sentences per GPU = 32 (train.py:222, single_main())
[2021-04-05 05:35:08]    INFO >> no existing checkpoint found checkpoint_best.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-05 05:35:08]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-05 05:35:08]    INFO >> Truncate dataset into max length: 513 (multitask_completion.py:46, load_token_dataset())
[2021-04-05 05:35:08]    INFO >> loaded 908224 examples from: ['/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/python', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/go', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/php', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/java', '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript'] (multitask_completion.py:47, load_token_dataset())
[2021-04-05 05:35:11]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-05 05:37:51]    INFO >> epoch 001:    500 / 7096 loss=4.774, accuracy=0, mrr=0, ppl=27.36, wps=41236.9, ups=3.28, wpb=12575.6, bsz=128, num_updates=500, lr=0.001, gnorm=0.804, clip=0, train_wall=152, wall=164 (progress_bar.py:260, log())
[2021-04-05 05:40:20]    INFO >> epoch 001:   1000 / 7096 loss=3.511, accuracy=0, mrr=0, ppl=11.4, wps=42430.2, ups=3.36, wpb=12624.8, bsz=128, num_updates=1000, lr=0.001, gnorm=0.651, clip=0, train_wall=148, wall=312 (progress_bar.py:260, log())
[2021-04-05 05:42:46]    INFO >> epoch 001:   1500 / 7096 loss=3, accuracy=0, mrr=0, ppl=8, wps=42821.4, ups=3.42, wpb=12533.8, bsz=128, num_updates=1500, lr=0.001, gnorm=0.604, clip=0, train_wall=145, wall=459 (progress_bar.py:260, log())
[2021-04-05 05:45:14]    INFO >> epoch 001:   2000 / 7096 loss=2.685, accuracy=0, mrr=0, ppl=6.43, wps=42543.2, ups=3.39, wpb=12541.6, bsz=128, num_updates=2000, lr=0.001, gnorm=0.566, clip=0, train_wall=146, wall=606 (progress_bar.py:260, log())
[2021-04-05 05:47:43]    INFO >> epoch 001:   2500 / 7096 loss=2.507, accuracy=0, mrr=0, ppl=5.68, wps=42423.3, ups=3.35, wpb=12644.9, bsz=128, num_updates=2500, lr=0.001, gnorm=0.525, clip=0, train_wall=148, wall=755 (progress_bar.py:260, log())
[2021-04-05 05:50:11]    INFO >> epoch 001:   3000 / 7096 loss=2.389, accuracy=0, mrr=0, ppl=5.24, wps=42639, ups=3.38, wpb=12624.1, bsz=128, num_updates=3000, lr=0.001, gnorm=0.497, clip=0, train_wall=147, wall=903 (progress_bar.py:260, log())
[2021-04-05 05:52:39]    INFO >> epoch 001:   3500 / 7096 loss=2.302, accuracy=0, mrr=0, ppl=4.93, wps=42299.1, ups=3.37, wpb=12542.6, bsz=128, num_updates=3500, lr=0.001, gnorm=0.467, clip=0, train_wall=147, wall=1051 (progress_bar.py:260, log())
[2021-04-05 05:55:08]    INFO >> epoch 001:   4000 / 7096 loss=2.236, accuracy=0, mrr=0, ppl=4.71, wps=42280.9, ups=3.36, wpb=12588.3, bsz=128, num_updates=4000, lr=0.001, gnorm=0.443, clip=0, train_wall=148, wall=1200 (progress_bar.py:260, log())
[2021-04-05 05:57:37]    INFO >> epoch 001:   4500 / 7096 loss=2.192, accuracy=0, mrr=0, ppl=4.57, wps=42142.1, ups=3.35, wpb=12583, bsz=128, num_updates=4500, lr=0.001, gnorm=0.424, clip=0, train_wall=148, wall=1350 (progress_bar.py:260, log())
[2021-04-05 06:00:06]    INFO >> epoch 001:   5000 / 7096 loss=2.151, accuracy=0, mrr=0, ppl=4.44, wps=42335.7, ups=3.35, wpb=12629.9, bsz=128, num_updates=5000, lr=0.001, gnorm=0.406, clip=0, train_wall=148, wall=1499 (progress_bar.py:260, log())
[2021-04-05 06:02:34]    INFO >> epoch 001:   5500 / 7096 loss=2.117, accuracy=0, mrr=0, ppl=4.34, wps=42554.3, ups=3.39, wpb=12556.7, bsz=128, num_updates=5500, lr=0.001, gnorm=0.395, clip=0, train_wall=146, wall=1646 (progress_bar.py:260, log())
[2021-04-05 06:05:03]    INFO >> epoch 001:   6000 / 7096 loss=2.082, accuracy=0, mrr=0, ppl=4.23, wps=42432.7, ups=3.36, wpb=12624.2, bsz=128, num_updates=6000, lr=0.001, gnorm=0.373, clip=0, train_wall=148, wall=1795 (progress_bar.py:260, log())
[2021-04-05 06:07:30]    INFO >> epoch 001:   6500 / 7096 loss=2.063, accuracy=0, mrr=0, ppl=4.18, wps=42746.9, ups=3.38, wpb=12633.2, bsz=128, num_updates=6500, lr=0.001, gnorm=0.367, clip=0, train_wall=147, wall=1943 (progress_bar.py:260, log())
[2021-04-05 06:09:58]    INFO >> epoch 001:   7000 / 7096 loss=2.045, accuracy=0, mrr=0, ppl=4.13, wps=42715.6, ups=3.38, wpb=12651.2, bsz=128, num_updates=7000, lr=0.001, gnorm=0.353, clip=0, train_wall=147, wall=2091 (progress_bar.py:260, log())
[2021-04-05 06:10:27]    INFO >> epoch 001 | loss 2.567 | accuracy 0 | mrr 0 | ppl 5.93 | wps 42392.5 | ups 3.37 | wpb 12597.3 | bsz 128 | num_updates 7096 | lr 0.001 | gnorm 0.489 | clip 0 | train_wall 2093 | wall 2120 (progress_bar.py:269, print())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-05 06:11:44]    INFO >> epoch 001 | valid on 'valid' subset | loss 2.114 | accuracy 0.668446 | mrr 0.763084 | ppl 4.33 | wps 61170.4 | wpb 24841.4 | bsz 255.4 | num_updates 7096 (progress_bar.py:269, print())
[2021-04-05 06:11:45]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 1 @ 7096 updates, score 0.763084) (writing took 1.122401 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 06:13:52]    INFO >> epoch 002:    404 / 7096 loss=2.01, accuracy=0, mrr=0, ppl=4.03, wps=26936.5, ups=2.14, wpb=12598.9, bsz=127.9, num_updates=7500, lr=0.001, gnorm=0.345, clip=0, train_wall=148, wall=2325 (progress_bar.py:260, log())
[2021-04-05 06:16:21]    INFO >> epoch 002:    904 / 7096 loss=1.991, accuracy=0, mrr=0, ppl=3.98, wps=42263.3, ups=3.35, wpb=12611.2, bsz=128, num_updates=8000, lr=0.001, gnorm=0.336, clip=0, train_wall=148, wall=2474 (progress_bar.py:260, log())
[2021-04-05 06:18:49]    INFO >> epoch 002:   1404 / 7096 loss=1.968, accuracy=0, mrr=0, ppl=3.91, wps=42410.4, ups=3.38, wpb=12546.1, bsz=128, num_updates=8500, lr=0.001, gnorm=0.324, clip=0, train_wall=147, wall=2622 (progress_bar.py:260, log())
[2021-04-05 06:21:16]    INFO >> epoch 002:   1904 / 7096 loss=1.946, accuracy=0, mrr=0, ppl=3.85, wps=42711.1, ups=3.41, wpb=12529.8, bsz=128, num_updates=9000, lr=0.001, gnorm=0.32, clip=0, train_wall=146, wall=2769 (progress_bar.py:260, log())
[2021-04-05 06:23:45]    INFO >> epoch 002:   2404 / 7096 loss=1.934, accuracy=0, mrr=0, ppl=3.82, wps=42438.8, ups=3.36, wpb=12641.8, bsz=128, num_updates=9500, lr=0.001, gnorm=0.311, clip=0, train_wall=148, wall=2917 (progress_bar.py:260, log())
[2021-04-05 06:26:13]    INFO >> epoch 002:   2904 / 7096 loss=1.925, accuracy=0, mrr=0, ppl=3.8, wps=42623.2, ups=3.38, wpb=12598, bsz=128, num_updates=10000, lr=0.001, gnorm=0.303, clip=0, train_wall=147, wall=3065 (progress_bar.py:260, log())
[2021-04-05 06:28:41]    INFO >> epoch 002:   3404 / 7096 loss=1.908, accuracy=0, mrr=0, ppl=3.75, wps=42387.1, ups=3.37, wpb=12584.2, bsz=128, num_updates=10500, lr=0.001, gnorm=0.298, clip=0, train_wall=147, wall=3214 (progress_bar.py:260, log())
[2021-04-05 06:31:10]    INFO >> epoch 002:   3904 / 7096 loss=1.899, accuracy=0, mrr=0, ppl=3.73, wps=42195.8, ups=3.35, wpb=12588.6, bsz=128, num_updates=11000, lr=0.001, gnorm=0.291, clip=0, train_wall=148, wall=3363 (progress_bar.py:260, log())
[2021-04-05 06:33:40]    INFO >> epoch 002:   4404 / 7096 loss=1.888, accuracy=0, mrr=0, ppl=3.7, wps=41938, ups=3.33, wpb=12581.5, bsz=128, num_updates=11500, lr=0.001, gnorm=0.288, clip=0, train_wall=149, wall=3513 (progress_bar.py:260, log())
[2021-04-05 06:36:09]    INFO >> epoch 002:   4904 / 7096 loss=1.879, accuracy=0, mrr=0, ppl=3.68, wps=42331.5, ups=3.35, wpb=12618.5, bsz=128, num_updates=12000, lr=0.001, gnorm=0.285, clip=0, train_wall=148, wall=3662 (progress_bar.py:260, log())
[2021-04-05 06:38:37]    INFO >> epoch 002:   5404 / 7096 loss=1.868, accuracy=0, mrr=0, ppl=3.65, wps=42420.8, ups=3.38, wpb=12541.8, bsz=128, num_updates=12500, lr=0.001, gnorm=0.277, clip=0, train_wall=147, wall=3810 (progress_bar.py:260, log())
[2021-04-05 06:41:06]    INFO >> epoch 002:   5904 / 7096 loss=1.856, accuracy=0, mrr=0, ppl=3.62, wps=42474.3, ups=3.36, wpb=12646.3, bsz=128, num_updates=13000, lr=0.001, gnorm=0.275, clip=0, train_wall=148, wall=3959 (progress_bar.py:260, log())
[2021-04-05 06:43:34]    INFO >> epoch 002:   6404 / 7096 loss=1.847, accuracy=0, mrr=0, ppl=3.6, wps=42578.9, ups=3.37, wpb=12632, bsz=128, num_updates=13500, lr=0.001, gnorm=0.272, clip=0, train_wall=147, wall=4107 (progress_bar.py:260, log())
[2021-04-05 06:46:03]    INFO >> epoch 002:   6904 / 7096 loss=1.845, accuracy=0, mrr=0, ppl=3.59, wps=42653, ups=3.37, wpb=12658.8, bsz=128, num_updates=14000, lr=0.001, gnorm=0.267, clip=0, train_wall=147, wall=4255 (progress_bar.py:260, log())
[2021-04-05 06:47:00]    INFO >> epoch 002 | loss 1.908 | accuracy 0 | mrr 0 | ppl 3.75 | wps 40768.7 | ups 3.24 | wpb 12597.3 | bsz 128 | num_updates 14192 | lr 0.001 | gnorm 0.298 | clip 0 | train_wall 2092 | wall 4312 (progress_bar.py:269, print())
[2021-04-05 06:48:11]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.992 | accuracy 0.684828 | mrr 0.776137 | ppl 3.98 | wps 66395.5 | wpb 24841.4 | bsz 255.4 | num_updates 14192 | best_mrr 0.776137 (progress_bar.py:269, print())
[2021-04-05 06:48:30]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 2 @ 14192 updates, score 0.776137) (writing took 19.230168 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 06:50:09]    INFO >> epoch 003:    308 / 7096 loss=1.83, accuracy=0, mrr=0, ppl=3.56, wps=25548.3, ups=2.03, wpb=12579.5, bsz=127.9, num_updates=14500, lr=0.001, gnorm=0.263, clip=0, train_wall=148, wall=4502 (progress_bar.py:260, log())
[2021-04-05 06:52:37]    INFO >> epoch 003:    808 / 7096 loss=1.82, accuracy=0, mrr=0, ppl=3.53, wps=42695, ups=3.38, wpb=12621.7, bsz=128, num_updates=15000, lr=0.001, gnorm=0.262, clip=0, train_wall=147, wall=4649 (progress_bar.py:260, log())
[2021-04-05 06:55:06]    INFO >> epoch 003:   1308 / 7096 loss=1.811, accuracy=0, mrr=0, ppl=3.51, wps=42202.4, ups=3.36, wpb=12563.6, bsz=128, num_updates=15500, lr=0.001, gnorm=0.258, clip=0, train_wall=148, wall=4798 (progress_bar.py:260, log())
[2021-04-05 06:57:31]    INFO >> epoch 003:   1808 / 7096 loss=1.799, accuracy=0, mrr=0, ppl=3.48, wps=42945.8, ups=3.43, wpb=12502.7, bsz=128, num_updates=16000, lr=0.001, gnorm=0.255, clip=0, train_wall=144, wall=4944 (progress_bar.py:260, log())
[2021-04-05 07:00:00]    INFO >> epoch 003:   2308 / 7096 loss=1.796, accuracy=0, mrr=0, ppl=3.47, wps=42534.6, ups=3.36, wpb=12643.6, bsz=128, num_updates=16500, lr=0.001, gnorm=0.252, clip=0, train_wall=148, wall=5092 (progress_bar.py:260, log())
[2021-04-05 07:02:28]    INFO >> epoch 003:   2808 / 7096 loss=1.792, accuracy=0, mrr=0, ppl=3.46, wps=42410.5, ups=3.37, wpb=12588.4, bsz=128, num_updates=17000, lr=0.001, gnorm=0.254, clip=0, train_wall=147, wall=5241 (progress_bar.py:260, log())
[2021-04-05 07:04:58]    INFO >> epoch 003:   3308 / 7096 loss=1.782, accuracy=0, mrr=0, ppl=3.44, wps=42292.8, ups=3.35, wpb=12622, bsz=128, num_updates=17500, lr=0.001, gnorm=0.248, clip=0, train_wall=148, wall=5390 (progress_bar.py:260, log())
[2021-04-05 07:07:26]    INFO >> epoch 003:   3808 / 7096 loss=1.779, accuracy=0, mrr=0, ppl=3.43, wps=42304.2, ups=3.36, wpb=12574.2, bsz=128, num_updates=18000, lr=0.001, gnorm=0.248, clip=0, train_wall=148, wall=5539 (progress_bar.py:260, log())
[2021-04-05 07:09:56]    INFO >> epoch 003:   4308 / 7096 loss=1.775, accuracy=0, mrr=0, ppl=3.42, wps=42119, ups=3.35, wpb=12579.4, bsz=128, num_updates=18500, lr=0.001, gnorm=0.246, clip=0, train_wall=148, wall=5688 (progress_bar.py:260, log())
[2021-04-05 07:12:26]    INFO >> epoch 003:   4808 / 7096 loss=1.769, accuracy=0, mrr=0, ppl=3.41, wps=41897.2, ups=3.33, wpb=12598.2, bsz=128, num_updates=19000, lr=0.001, gnorm=0.243, clip=0, train_wall=149, wall=5838 (progress_bar.py:260, log())
[2021-04-05 07:14:54]    INFO >> epoch 003:   5308 / 7096 loss=1.762, accuracy=0, mrr=0, ppl=3.39, wps=42573.1, ups=3.39, wpb=12571.6, bsz=128, num_updates=19500, lr=0.001, gnorm=0.243, clip=0, train_wall=147, wall=5986 (progress_bar.py:260, log())
[2021-04-05 07:17:22]    INFO >> epoch 003:   5808 / 7096 loss=1.751, accuracy=0, mrr=0, ppl=3.37, wps=42480.1, ups=3.37, wpb=12607.4, bsz=128, num_updates=20000, lr=0.001, gnorm=0.239, clip=0, train_wall=147, wall=6134 (progress_bar.py:260, log())
[2021-04-05 07:19:50]    INFO >> epoch 003:   6308 / 7096 loss=1.75, accuracy=0, mrr=0, ppl=3.36, wps=42455, ups=3.37, wpb=12608.5, bsz=128, num_updates=20500, lr=0.001, gnorm=0.239, clip=0, train_wall=147, wall=6283 (progress_bar.py:260, log())
[2021-04-05 07:22:19]    INFO >> epoch 003:   6808 / 7096 loss=1.749, accuracy=0, mrr=0, ppl=3.36, wps=42697.8, ups=3.37, wpb=12659.2, bsz=128, num_updates=21000, lr=0.001, gnorm=0.241, clip=0, train_wall=147, wall=6431 (progress_bar.py:260, log())
[2021-04-05 07:23:45]    INFO >> epoch 003 | loss 1.78 | accuracy 0 | mrr 0 | ppl 3.43 | wps 40542.7 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 21288 | lr 0.001 | gnorm 0.249 | clip 0 | train_wall 2092 | wall 6517 (progress_bar.py:269, print())
[2021-04-05 07:24:56]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.949 | accuracy 0.690665 | mrr 0.780747 | ppl 3.86 | wps 66499.6 | wpb 24841.4 | bsz 255.4 | num_updates 21288 | best_mrr 0.780747 (progress_bar.py:269, print())
[2021-04-05 07:25:15]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 3 @ 21288 updates, score 0.780747) (writing took 19.401800 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 07:26:25]    INFO >> epoch 004:    212 / 7096 loss=1.741, accuracy=0, mrr=0, ppl=3.34, wps=25610, ups=2.03, wpb=12626.4, bsz=127.9, num_updates=21500, lr=0.001, gnorm=0.238, clip=0, train_wall=148, wall=6678 (progress_bar.py:260, log())
[2021-04-05 07:28:53]    INFO >> epoch 004:    712 / 7096 loss=1.732, accuracy=0, mrr=0, ppl=3.32, wps=42570.9, ups=3.38, wpb=12606.8, bsz=128, num_updates=22000, lr=0.001, gnorm=0.237, clip=0, train_wall=147, wall=6826 (progress_bar.py:260, log())
[2021-04-05 07:31:23]    INFO >> epoch 004:   1212 / 7096 loss=1.728, accuracy=0, mrr=0, ppl=3.31, wps=42133, ups=3.34, wpb=12601.3, bsz=128, num_updates=22500, lr=0.001, gnorm=0.233, clip=0, train_wall=148, wall=6975 (progress_bar.py:260, log())
[2021-04-05 07:33:48]    INFO >> epoch 004:   1712 / 7096 loss=1.723, accuracy=0, mrr=0, ppl=3.3, wps=42905.6, ups=3.43, wpb=12494.8, bsz=128, num_updates=23000, lr=0.001, gnorm=0.237, clip=0, train_wall=145, wall=7121 (progress_bar.py:260, log())
[2021-04-05 07:36:17]    INFO >> epoch 004:   2212 / 7096 loss=1.715, accuracy=0, mrr=0, ppl=3.28, wps=42313.5, ups=3.36, wpb=12608.6, bsz=128, num_updates=23500, lr=0.001, gnorm=0.233, clip=0, train_wall=148, wall=7270 (progress_bar.py:260, log())
[2021-04-05 07:38:46]    INFO >> epoch 004:   2712 / 7096 loss=1.718, accuracy=0, mrr=0, ppl=3.29, wps=42554, ups=3.37, wpb=12619.9, bsz=128, num_updates=24000, lr=0.001, gnorm=0.234, clip=0, train_wall=147, wall=7418 (progress_bar.py:260, log())
[2021-04-05 07:41:15]    INFO >> epoch 004:   3212 / 7096 loss=1.711, accuracy=0, mrr=0, ppl=3.27, wps=42445, ups=3.36, wpb=12643.8, bsz=128, num_updates=24500, lr=0.001, gnorm=0.234, clip=0, train_wall=148, wall=7567 (progress_bar.py:260, log())
[2021-04-05 07:43:43]    INFO >> epoch 004:   3712 / 7096 loss=1.711, accuracy=0, mrr=0, ppl=3.27, wps=42081.9, ups=3.36, wpb=12507.2, bsz=128, num_updates=25000, lr=0.001, gnorm=0.233, clip=0, train_wall=148, wall=7716 (progress_bar.py:260, log())
[2021-04-05 07:46:12]    INFO >> epoch 004:   4212 / 7096 loss=1.703, accuracy=0, mrr=0, ppl=3.26, wps=42295.9, ups=3.36, wpb=12604.4, bsz=128, num_updates=25500, lr=0.001, gnorm=0.229, clip=0, train_wall=148, wall=7865 (progress_bar.py:260, log())
[2021-04-05 07:48:43]    INFO >> epoch 004:   4712 / 7096 loss=1.702, accuracy=0, mrr=0, ppl=3.25, wps=41783.3, ups=3.31, wpb=12612.8, bsz=128, num_updates=26000, lr=0.001, gnorm=0.228, clip=0, train_wall=150, wall=8016 (progress_bar.py:260, log())
[2021-04-05 07:51:11]    INFO >> epoch 004:   5212 / 7096 loss=1.699, accuracy=0, mrr=0, ppl=3.25, wps=42588.7, ups=3.38, wpb=12582.8, bsz=128, num_updates=26500, lr=0.001, gnorm=0.232, clip=0, train_wall=147, wall=8163 (progress_bar.py:260, log())
[2021-04-05 07:53:39]    INFO >> epoch 004:   5712 / 7096 loss=1.69, accuracy=0, mrr=0, ppl=3.23, wps=42376.9, ups=3.36, wpb=12594.6, bsz=128, num_updates=27000, lr=0.001, gnorm=0.228, clip=0, train_wall=148, wall=8312 (progress_bar.py:260, log())
[2021-04-05 07:56:07]    INFO >> epoch 004:   6212 / 7096 loss=1.688, accuracy=0, mrr=0, ppl=3.22, wps=42493.8, ups=3.38, wpb=12565.2, bsz=128, num_updates=27500, lr=0.001, gnorm=0.227, clip=0, train_wall=147, wall=8460 (progress_bar.py:260, log())
[2021-04-05 07:58:35]    INFO >> epoch 004:   6712 / 7096 loss=1.689, accuracy=0, mrr=0, ppl=3.22, wps=42857.9, ups=3.38, wpb=12684.8, bsz=128, num_updates=28000, lr=0.001, gnorm=0.233, clip=0, train_wall=147, wall=8608 (progress_bar.py:260, log())
[2021-04-05 08:00:30]    INFO >> epoch 004 | loss 1.708 | accuracy 0 | mrr 0 | ppl 3.27 | wps 40541.4 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 28384 | lr 0.001 | gnorm 0.232 | clip 0 | train_wall 2092 | wall 8722 (progress_bar.py:269, print())
[2021-04-05 08:01:41]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.933 | accuracy 0.693403 | mrr 0.782786 | ppl 3.82 | wps 66444.1 | wpb 24841.4 | bsz 255.4 | num_updates 28384 | best_mrr 0.782786 (progress_bar.py:269, print())
[2021-04-05 08:02:00]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 4 @ 28384 updates, score 0.782786) (writing took 19.290221 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 08:02:42]    INFO >> epoch 005:    116 / 7096 loss=1.686, accuracy=0, mrr=0, ppl=3.22, wps=25652.2, ups=2.03, wpb=12632.8, bsz=127.9, num_updates=28500, lr=0.001, gnorm=0.232, clip=0, train_wall=148, wall=8854 (progress_bar.py:260, log())
[2021-04-05 08:05:11]    INFO >> epoch 005:    616 / 7096 loss=1.677, accuracy=0, mrr=0, ppl=3.2, wps=42235.9, ups=3.35, wpb=12600.6, bsz=128, num_updates=29000, lr=0.001, gnorm=0.23, clip=0, train_wall=148, wall=9003 (progress_bar.py:260, log())
[2021-04-05 08:07:39]    INFO >> epoch 005:   1116 / 7096 loss=1.671, accuracy=0, mrr=0, ppl=3.18, wps=42446, ups=3.37, wpb=12607.9, bsz=128, num_updates=29500, lr=0.001, gnorm=0.228, clip=0, train_wall=147, wall=9152 (progress_bar.py:260, log())
[2021-04-05 08:10:05]    INFO >> epoch 005:   1616 / 7096 loss=1.671, accuracy=0, mrr=0, ppl=3.19, wps=42872.9, ups=3.43, wpb=12505.4, bsz=128, num_updates=30000, lr=0.001, gnorm=0.226, clip=0, train_wall=145, wall=9298 (progress_bar.py:260, log())
[2021-04-05 08:12:34]    INFO >> epoch 005:   2116 / 7096 loss=1.661, accuracy=0, mrr=0, ppl=3.16, wps=42348.1, ups=3.36, wpb=12616.2, bsz=128, num_updates=30500, lr=0.001, gnorm=0.228, clip=0, train_wall=148, wall=9447 (progress_bar.py:260, log())
[2021-04-05 08:15:03]    INFO >> epoch 005:   2616 / 7096 loss=1.669, accuracy=0, mrr=0, ppl=3.18, wps=42347.9, ups=3.36, wpb=12611.2, bsz=128, num_updates=31000, lr=0.001, gnorm=0.23, clip=0, train_wall=148, wall=9595 (progress_bar.py:260, log())
[2021-04-05 08:17:31]    INFO >> epoch 005:   3116 / 7096 loss=1.663, accuracy=0, mrr=0, ppl=3.17, wps=42635.8, ups=3.37, wpb=12643.2, bsz=128, num_updates=31500, lr=0.001, gnorm=0.23, clip=0, train_wall=147, wall=9744 (progress_bar.py:260, log())
[2021-04-05 08:19:59]    INFO >> epoch 005:   3616 / 7096 loss=1.664, accuracy=0, mrr=0, ppl=3.17, wps=42252.8, ups=3.38, wpb=12504.1, bsz=128, num_updates=32000, lr=0.001, gnorm=0.231, clip=0, train_wall=147, wall=9892 (progress_bar.py:260, log())
[2021-04-05 08:22:29]    INFO >> epoch 005:   4116 / 7096 loss=1.652, accuracy=0, mrr=0, ppl=3.14, wps=42002.4, ups=3.34, wpb=12580.6, bsz=128, num_updates=32500, lr=0.001, gnorm=0.225, clip=0, train_wall=149, wall=10041 (progress_bar.py:260, log())
[2021-04-05 08:24:59]    INFO >> epoch 005:   4616 / 7096 loss=1.658, accuracy=0, mrr=0, ppl=3.16, wps=42211.2, ups=3.34, wpb=12635.1, bsz=128, num_updates=33000, lr=0.001, gnorm=0.226, clip=0, train_wall=149, wall=10191 (progress_bar.py:260, log())
[2021-04-05 08:27:27]    INFO >> epoch 005:   5116 / 7096 loss=1.654, accuracy=0, mrr=0, ppl=3.15, wps=42341.9, ups=3.36, wpb=12585.3, bsz=128, num_updates=33500, lr=0.001, gnorm=0.23, clip=0, train_wall=148, wall=10340 (progress_bar.py:260, log())
[2021-04-05 08:29:56]    INFO >> epoch 005:   5616 / 7096 loss=1.649, accuracy=0, mrr=0, ppl=3.14, wps=42441.9, ups=3.37, wpb=12600.8, bsz=128, num_updates=34000, lr=0.001, gnorm=0.228, clip=0, train_wall=147, wall=10488 (progress_bar.py:260, log())
[2021-04-05 08:32:24]    INFO >> epoch 005:   6116 / 7096 loss=1.644, accuracy=0, mrr=0, ppl=3.12, wps=42273.5, ups=3.36, wpb=12581, bsz=128, num_updates=34500, lr=0.001, gnorm=0.228, clip=0, train_wall=148, wall=10637 (progress_bar.py:260, log())
[2021-04-05 08:34:53]    INFO >> epoch 005:   6616 / 7096 loss=1.644, accuracy=0, mrr=0, ppl=3.13, wps=42514.6, ups=3.36, wpb=12648.2, bsz=128, num_updates=35000, lr=0.001, gnorm=0.231, clip=0, train_wall=148, wall=10786 (progress_bar.py:260, log())
[2021-04-05 08:37:15]    INFO >> epoch 005 | loss 1.659 | accuracy 0 | mrr 0 | ppl 3.16 | wps 40527.9 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 35480 | lr 0.001 | gnorm 0.229 | clip 0 | train_wall 2093 | wall 10928 (progress_bar.py:269, print())
[2021-04-05 08:38:26]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.928 | accuracy 0.694964 | mrr 0.784011 | ppl 3.81 | wps 66637.3 | wpb 24841.4 | bsz 255.4 | num_updates 35480 | best_mrr 0.784011 (progress_bar.py:269, print())
[2021-04-05 08:38:46]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 5 @ 35480 updates, score 0.784011) (writing took 19.255047 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 08:38:57]    INFO >> epoch 006:     20 / 7096 loss=1.645, accuracy=0, mrr=0, ppl=3.13, wps=25859.3, ups=2.05, wpb=12627.6, bsz=127.9, num_updates=35500, lr=0.001, gnorm=0.233, clip=0, train_wall=146, wall=11030 (progress_bar.py:260, log())
[2021-04-05 08:41:25]    INFO >> epoch 006:    520 / 7096 loss=1.609, accuracy=0, mrr=0, ppl=3.05, wps=42523, ups=3.38, wpb=12572.9, bsz=128, num_updates=36000, lr=0.001, gnorm=0.223, clip=0, train_wall=147, wall=11178 (progress_bar.py:260, log())
[2021-04-05 08:43:52]    INFO >> epoch 006:   1020 / 7096 loss=1.618, accuracy=0, mrr=0, ppl=3.07, wps=42963.9, ups=3.4, wpb=12633.5, bsz=128, num_updates=36500, lr=0.001, gnorm=0.223, clip=0, train_wall=146, wall=11325 (progress_bar.py:260, log())
[2021-04-05 08:46:22]    INFO >> epoch 006:   1520 / 7096 loss=1.621, accuracy=0, mrr=0, ppl=3.08, wps=42253.9, ups=3.35, wpb=12618.6, bsz=128, num_updates=37000, lr=0.001, gnorm=0.223, clip=0, train_wall=148, wall=11474 (progress_bar.py:260, log())
[2021-04-05 08:48:53]    INFO >> epoch 006:   2020 / 7096 loss=1.622, accuracy=0, mrr=0, ppl=3.08, wps=41806.6, ups=3.31, wpb=12645.6, bsz=128, num_updates=37500, lr=0.001, gnorm=0.225, clip=0, train_wall=150, wall=11625 (progress_bar.py:260, log())
[2021-04-05 08:51:21]    INFO >> epoch 006:   2520 / 7096 loss=1.625, accuracy=0, mrr=0, ppl=3.08, wps=42461.3, ups=3.37, wpb=12603.2, bsz=128, num_updates=38000, lr=0.001, gnorm=0.222, clip=0, train_wall=147, wall=11774 (progress_bar.py:260, log())
[2021-04-05 08:53:51]    INFO >> epoch 006:   3020 / 7096 loss=1.634, accuracy=0, mrr=0, ppl=3.1, wps=41933.7, ups=3.33, wpb=12592, bsz=128, num_updates=38500, lr=0.001, gnorm=0.223, clip=0, train_wall=149, wall=11924 (progress_bar.py:260, log())
[2021-04-05 08:56:20]    INFO >> epoch 006:   3520 / 7096 loss=1.636, accuracy=0, mrr=0, ppl=3.11, wps=42302.5, ups=3.36, wpb=12572.3, bsz=128, num_updates=39000, lr=0.001, gnorm=0.227, clip=0, train_wall=148, wall=12072 (progress_bar.py:260, log())
[2021-04-05 08:58:50]    INFO >> epoch 006:   4020 / 7096 loss=1.632, accuracy=0, mrr=0, ppl=3.1, wps=42249.1, ups=3.34, wpb=12649.6, bsz=128, num_updates=39500, lr=0.001, gnorm=0.221, clip=0, train_wall=149, wall=12222 (progress_bar.py:260, log())
[2021-04-05 09:01:18]    INFO >> epoch 006:   4520 / 7096 loss=1.637, accuracy=0, mrr=0, ppl=3.11, wps=42612.7, ups=3.37, wpb=12655.8, bsz=128, num_updates=40000, lr=0.001, gnorm=0.223, clip=0, train_wall=147, wall=12371 (progress_bar.py:260, log())
[2021-04-05 09:03:47]    INFO >> epoch 006:   5020 / 7096 loss=1.636, accuracy=0, mrr=0, ppl=3.11, wps=42388.1, ups=3.37, wpb=12577.7, bsz=128, num_updates=40500, lr=0.001, gnorm=0.22, clip=0, train_wall=147, wall=12519 (progress_bar.py:260, log())
[2021-04-05 09:06:16]    INFO >> epoch 006:   5520 / 7096 loss=1.641, accuracy=0, mrr=0, ppl=3.12, wps=41863.7, ups=3.35, wpb=12507.6, bsz=128, num_updates=41000, lr=0.001, gnorm=0.224, clip=0, train_wall=148, wall=12668 (progress_bar.py:260, log())
[2021-04-05 09:08:45]    INFO >> epoch 006:   6020 / 7096 loss=1.638, accuracy=0, mrr=0, ppl=3.11, wps=42219.9, ups=3.35, wpb=12589.9, bsz=128, num_updates=41500, lr=0.001, gnorm=0.224, clip=0, train_wall=148, wall=12817 (progress_bar.py:260, log())
[2021-04-05 09:11:12]    INFO >> epoch 006:   6520 / 7096 loss=1.644, accuracy=0, mrr=0, ppl=3.13, wps=42944.3, ups=3.4, wpb=12643.7, bsz=128, num_updates=42000, lr=0.001, gnorm=0.223, clip=0, train_wall=146, wall=12965 (progress_bar.py:260, log())
[2021-04-05 09:13:40]    INFO >> epoch 006:   7020 / 7096 loss=1.643, accuracy=0, mrr=0, ppl=3.12, wps=42449.1, ups=3.38, wpb=12540.7, bsz=128, num_updates=42500, lr=0.001, gnorm=0.223, clip=0, train_wall=147, wall=13112 (progress_bar.py:260, log())
[2021-04-05 09:14:03]    INFO >> epoch 006 | loss 1.631 | accuracy 0 | mrr 0 | ppl 3.1 | wps 40482.6 | ups 3.21 | wpb 12597.3 | bsz 128 | num_updates 42576 | lr 0.001 | gnorm 0.223 | clip 0 | train_wall 2096 | wall 13136 (progress_bar.py:269, print())
[2021-04-05 09:15:15]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.896 | accuracy 0.69918 | mrr 0.787165 | ppl 3.72 | wps 66574.4 | wpb 24841.4 | bsz 255.4 | num_updates 42576 | best_mrr 0.787165 (progress_bar.py:269, print())
[2021-04-05 09:15:34]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 6 @ 42576 updates, score 0.787165) (writing took 19.201149 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 09:17:45]    INFO >> epoch 007:    424 / 7096 loss=1.577, accuracy=0, mrr=0, ppl=2.98, wps=25544.3, ups=2.04, wpb=12513.3, bsz=127.9, num_updates=43000, lr=0.001, gnorm=0.223, clip=0, train_wall=147, wall=13357 (progress_bar.py:260, log())
[2021-04-05 09:20:13]    INFO >> epoch 007:    924 / 7096 loss=1.58, accuracy=0, mrr=0, ppl=2.99, wps=42530.5, ups=3.38, wpb=12587.8, bsz=128, num_updates=43500, lr=0.001, gnorm=0.227, clip=0, train_wall=147, wall=13505 (progress_bar.py:260, log())
[2021-04-05 09:22:41]    INFO >> epoch 007:   1424 / 7096 loss=1.585, accuracy=0, mrr=0, ppl=3, wps=42568.1, ups=3.37, wpb=12646.7, bsz=128, num_updates=44000, lr=0.001, gnorm=0.227, clip=0, train_wall=147, wall=13654 (progress_bar.py:260, log())
[2021-04-05 09:25:09]    INFO >> epoch 007:   1924 / 7096 loss=1.586, accuracy=0, mrr=0, ppl=3, wps=42467.7, ups=3.38, wpb=12553.4, bsz=128, num_updates=44500, lr=0.001, gnorm=0.225, clip=0, train_wall=147, wall=13802 (progress_bar.py:260, log())
[2021-04-05 09:27:38]    INFO >> epoch 007:   2424 / 7096 loss=1.59, accuracy=0, mrr=0, ppl=3.01, wps=42319.3, ups=3.35, wpb=12629.5, bsz=128, num_updates=45000, lr=0.001, gnorm=0.224, clip=0, train_wall=148, wall=13951 (progress_bar.py:260, log())
[2021-04-05 09:30:07]    INFO >> epoch 007:   2924 / 7096 loss=1.601, accuracy=0, mrr=0, ppl=3.03, wps=42358.7, ups=3.36, wpb=12618.2, bsz=128, num_updates=45500, lr=0.001, gnorm=0.228, clip=0, train_wall=148, wall=14100 (progress_bar.py:260, log())
[2021-04-05 09:32:35]    INFO >> epoch 007:   3424 / 7096 loss=1.598, accuracy=0, mrr=0, ppl=3.03, wps=42721.1, ups=3.39, wpb=12611.3, bsz=128, num_updates=46000, lr=0.001, gnorm=0.231, clip=0, train_wall=147, wall=14247 (progress_bar.py:260, log())
[2021-04-05 09:35:03]    INFO >> epoch 007:   3924 / 7096 loss=1.605, accuracy=0, mrr=0, ppl=3.04, wps=42305.2, ups=3.37, wpb=12539.1, bsz=128, num_updates=46500, lr=0.001, gnorm=0.225, clip=0, train_wall=147, wall=14396 (progress_bar.py:260, log())
[2021-04-05 09:37:32]    INFO >> epoch 007:   4424 / 7096 loss=1.604, accuracy=0, mrr=0, ppl=3.04, wps=42081, ups=3.35, wpb=12559.7, bsz=128, num_updates=47000, lr=0.001, gnorm=0.225, clip=0, train_wall=148, wall=14545 (progress_bar.py:260, log())
[2021-04-05 09:40:02]    INFO >> epoch 007:   4924 / 7096 loss=1.609, accuracy=0, mrr=0, ppl=3.05, wps=42537.3, ups=3.35, wpb=12707.2, bsz=128, num_updates=47500, lr=0.001, gnorm=0.229, clip=0, train_wall=148, wall=14694 (progress_bar.py:260, log())
[2021-04-05 09:42:30]    INFO >> epoch 007:   5424 / 7096 loss=1.609, accuracy=0, mrr=0, ppl=3.05, wps=42365.9, ups=3.36, wpb=12597.4, bsz=128, num_updates=48000, lr=0.001, gnorm=0.226, clip=0, train_wall=148, wall=14843 (progress_bar.py:260, log())
[2021-04-05 09:44:59]    INFO >> epoch 007:   5924 / 7096 loss=1.609, accuracy=0, mrr=0, ppl=3.05, wps=42215, ups=3.36, wpb=12580.1, bsz=128, num_updates=48500, lr=0.001, gnorm=0.227, clip=0, train_wall=148, wall=14992 (progress_bar.py:260, log())
[2021-04-05 09:47:29]    INFO >> epoch 007:   6424 / 7096 loss=1.606, accuracy=0, mrr=0, ppl=3.04, wps=42124.3, ups=3.35, wpb=12582.6, bsz=128, num_updates=49000, lr=0.001, gnorm=0.227, clip=0, train_wall=148, wall=15141 (progress_bar.py:260, log())
[2021-04-05 09:49:58]    INFO >> epoch 007:   6924 / 7096 loss=1.611, accuracy=0, mrr=0, ppl=3.06, wps=42222.9, ups=3.34, wpb=12628.4, bsz=128, num_updates=49500, lr=0.001, gnorm=0.23, clip=0, train_wall=148, wall=15291 (progress_bar.py:260, log())
[2021-04-05 09:50:50]    INFO >> epoch 007 | loss 1.598 | accuracy 0 | mrr 0 | ppl 3.03 | wps 40507.6 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 49672 | lr 0.001 | gnorm 0.227 | clip 0 | train_wall 2094 | wall 15343 (progress_bar.py:269, print())
[2021-04-05 09:52:01]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.886 | accuracy 0.701172 | mrr 0.788725 | ppl 3.7 | wps 66516.3 | wpb 24841.4 | bsz 255.4 | num_updates 49672 | best_mrr 0.788725 (progress_bar.py:269, print())
[2021-04-05 09:52:21]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 7 @ 49672 updates, score 0.788725) (writing took 19.596476 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 09:54:04]    INFO >> epoch 008:    328 / 7096 loss=1.568, accuracy=0, mrr=0, ppl=2.96, wps=25581.6, ups=2.03, wpb=12584.7, bsz=127.9, num_updates=50000, lr=0.001, gnorm=0.23, clip=0, train_wall=147, wall=15537 (progress_bar.py:260, log())
[2021-04-05 09:56:33]    INFO >> epoch 008:    828 / 7096 loss=1.546, accuracy=0, mrr=0, ppl=2.92, wps=42563.3, ups=3.37, wpb=12620.8, bsz=128, num_updates=50500, lr=0.001, gnorm=0.23, clip=0, train_wall=147, wall=15685 (progress_bar.py:260, log())
[2021-04-05 09:59:00]    INFO >> epoch 008:   1328 / 7096 loss=1.558, accuracy=0, mrr=0, ppl=2.94, wps=42785.7, ups=3.4, wpb=12590.4, bsz=128, num_updates=51000, lr=0.001, gnorm=0.234, clip=0, train_wall=146, wall=15832 (progress_bar.py:260, log())
[2021-04-05 10:01:28]    INFO >> epoch 008:   1828 / 7096 loss=1.556, accuracy=0, mrr=0, ppl=2.94, wps=42465.3, ups=3.38, wpb=12567.7, bsz=128, num_updates=51500, lr=0.001, gnorm=0.231, clip=0, train_wall=147, wall=15980 (progress_bar.py:260, log())
[2021-04-05 10:03:56]    INFO >> epoch 008:   2328 / 7096 loss=1.567, accuracy=0, mrr=0, ppl=2.96, wps=42360.2, ups=3.37, wpb=12562.8, bsz=128, num_updates=52000, lr=0.001, gnorm=0.234, clip=0, train_wall=147, wall=16128 (progress_bar.py:260, log())
[2021-04-05 10:06:24]    INFO >> epoch 008:   2828 / 7096 loss=1.567, accuracy=0, mrr=0, ppl=2.96, wps=42385, ups=3.37, wpb=12576.5, bsz=128, num_updates=52500, lr=0.001, gnorm=0.234, clip=0, train_wall=147, wall=16277 (progress_bar.py:260, log())
[2021-04-05 10:08:53]    INFO >> epoch 008:   3328 / 7096 loss=1.579, accuracy=0, mrr=0, ppl=2.99, wps=42398, ups=3.37, wpb=12586.5, bsz=128, num_updates=53000, lr=0.001, gnorm=0.233, clip=0, train_wall=147, wall=16425 (progress_bar.py:260, log())
[2021-04-05 10:11:20]    INFO >> epoch 008:   3828 / 7096 loss=1.578, accuracy=0, mrr=0, ppl=2.98, wps=42370.5, ups=3.39, wpb=12506.2, bsz=128, num_updates=53500, lr=0.001, gnorm=0.234, clip=0, train_wall=146, wall=16573 (progress_bar.py:260, log())
[2021-04-05 10:13:50]    INFO >> epoch 008:   4328 / 7096 loss=1.582, accuracy=0, mrr=0, ppl=2.99, wps=42285.9, ups=3.34, wpb=12643.8, bsz=128, num_updates=54000, lr=0.001, gnorm=0.235, clip=0, train_wall=148, wall=16722 (progress_bar.py:260, log())
[2021-04-05 10:16:20]    INFO >> epoch 008:   4828 / 7096 loss=1.572, accuracy=0, mrr=0, ppl=2.97, wps=42108.8, ups=3.33, wpb=12641.9, bsz=128, num_updates=54500, lr=0.001, gnorm=0.232, clip=0, train_wall=149, wall=16872 (progress_bar.py:260, log())
[2021-04-05 10:18:50]    INFO >> epoch 008:   5328 / 7096 loss=1.583, accuracy=0, mrr=0, ppl=3, wps=42246.4, ups=3.34, wpb=12661.4, bsz=128, num_updates=55000, lr=0.001, gnorm=0.234, clip=0, train_wall=149, wall=17022 (progress_bar.py:260, log())
[2021-04-05 10:21:19]    INFO >> epoch 008:   5828 / 7096 loss=1.582, accuracy=0, mrr=0, ppl=2.99, wps=42300.7, ups=3.35, wpb=12620.5, bsz=128, num_updates=55500, lr=0.001, gnorm=0.23, clip=0, train_wall=148, wall=17171 (progress_bar.py:260, log())
[2021-04-05 10:23:48]    INFO >> epoch 008:   6328 / 7096 loss=1.588, accuracy=0, mrr=0, ppl=3.01, wps=42201, ups=3.36, wpb=12563.8, bsz=128, num_updates=56000, lr=0.001, gnorm=0.232, clip=0, train_wall=148, wall=17320 (progress_bar.py:260, log())
[2021-04-05 10:26:17]    INFO >> epoch 008:   6828 / 7096 loss=1.586, accuracy=0, mrr=0, ppl=3, wps=42305.7, ups=3.34, wpb=12651.9, bsz=128, num_updates=56500, lr=0.001, gnorm=0.231, clip=0, train_wall=148, wall=17470 (progress_bar.py:260, log())
[2021-04-05 10:27:36]    INFO >> epoch 008 | loss 1.572 | accuracy 0 | mrr 0 | ppl 2.97 | wps 40516.4 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 56768 | lr 0.001 | gnorm 0.233 | clip 0 | train_wall 2094 | wall 17549 (progress_bar.py:269, print())
[2021-04-05 10:28:48]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.888 | accuracy 0.701809 | mrr 0.788946 | ppl 3.7 | wps 66457.6 | wpb 24841.4 | bsz 255.4 | num_updates 56768 | best_mrr 0.788946 (progress_bar.py:269, print())
[2021-04-05 10:29:07]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 8 @ 56768 updates, score 0.788946) (writing took 19.269371 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 10:30:21]    INFO >> epoch 009:    232 / 7096 loss=1.553, accuracy=0, mrr=0, ppl=2.93, wps=25728.5, ups=2.05, wpb=12550, bsz=127.9, num_updates=57000, lr=0.001, gnorm=0.235, clip=0, train_wall=146, wall=17714 (progress_bar.py:260, log())
[2021-04-05 10:32:51]    INFO >> epoch 009:    732 / 7096 loss=1.521, accuracy=0, mrr=0, ppl=2.87, wps=42244.4, ups=3.34, wpb=12633.7, bsz=128, num_updates=57500, lr=0.001, gnorm=0.239, clip=0, train_wall=148, wall=17863 (progress_bar.py:260, log())
[2021-04-05 10:35:20]    INFO >> epoch 009:   1232 / 7096 loss=1.53, accuracy=0, mrr=0, ppl=2.89, wps=42442.5, ups=3.35, wpb=12652.5, bsz=128, num_updates=58000, lr=0.001, gnorm=0.238, clip=0, train_wall=148, wall=18012 (progress_bar.py:260, log())
[2021-04-05 10:37:50]    INFO >> epoch 009:   1732 / 7096 loss=1.535, accuracy=0, mrr=0, ppl=2.9, wps=42183, ups=3.34, wpb=12634.5, bsz=128, num_updates=58500, lr=0.001, gnorm=0.235, clip=0, train_wall=149, wall=18162 (progress_bar.py:260, log())
[2021-04-05 10:40:19]    INFO >> epoch 009:   2232 / 7096 loss=1.543, accuracy=0, mrr=0, ppl=2.91, wps=42197.6, ups=3.34, wpb=12646, bsz=128, num_updates=59000, lr=0.001, gnorm=0.238, clip=0, train_wall=149, wall=18312 (progress_bar.py:260, log())
[2021-04-05 10:42:47]    INFO >> epoch 009:   2732 / 7096 loss=1.549, accuracy=0, mrr=0, ppl=2.93, wps=42648.4, ups=3.38, wpb=12610.9, bsz=128, num_updates=59500, lr=0.001, gnorm=0.238, clip=0, train_wall=147, wall=18460 (progress_bar.py:260, log())
[2021-04-05 10:45:15]    INFO >> epoch 009:   3232 / 7096 loss=1.551, accuracy=0, mrr=0, ppl=2.93, wps=42503.2, ups=3.38, wpb=12562.7, bsz=128, num_updates=60000, lr=0.001, gnorm=0.239, clip=0, train_wall=147, wall=18608 (progress_bar.py:260, log())
[2021-04-05 10:47:43]    INFO >> epoch 009:   3732 / 7096 loss=1.556, accuracy=0, mrr=0, ppl=2.94, wps=42503.2, ups=3.37, wpb=12603.1, bsz=128, num_updates=60500, lr=0.001, gnorm=0.24, clip=0, train_wall=147, wall=18756 (progress_bar.py:260, log())
[2021-04-05 10:50:11]    INFO >> epoch 009:   4232 / 7096 loss=1.556, accuracy=0, mrr=0, ppl=2.94, wps=42531.9, ups=3.38, wpb=12585.3, bsz=128, num_updates=61000, lr=0.001, gnorm=0.239, clip=0, train_wall=147, wall=18904 (progress_bar.py:260, log())
[2021-04-05 10:52:41]    INFO >> epoch 009:   4732 / 7096 loss=1.554, accuracy=0, mrr=0, ppl=2.94, wps=42165, ups=3.34, wpb=12617, bsz=128, num_updates=61500, lr=0.001, gnorm=0.237, clip=0, train_wall=149, wall=19053 (progress_bar.py:260, log())
[2021-04-05 10:55:08]    INFO >> epoch 009:   5232 / 7096 loss=1.564, accuracy=0, mrr=0, ppl=2.96, wps=42831.2, ups=3.4, wpb=12590.9, bsz=128, num_updates=62000, lr=0.001, gnorm=0.237, clip=0, train_wall=146, wall=19200 (progress_bar.py:260, log())
[2021-04-05 10:57:35]    INFO >> epoch 009:   5732 / 7096 loss=1.564, accuracy=0, mrr=0, ppl=2.96, wps=42562.4, ups=3.4, wpb=12529.9, bsz=128, num_updates=62500, lr=0.001, gnorm=0.244, clip=0, train_wall=146, wall=19348 (progress_bar.py:260, log())
[2021-04-05 11:00:03]    INFO >> epoch 009:   6232 / 7096 loss=1.569, accuracy=0, mrr=0, ppl=2.97, wps=42331.9, ups=3.38, wpb=12527.6, bsz=128, num_updates=63000, lr=0.001, gnorm=0.242, clip=0, train_wall=147, wall=19496 (progress_bar.py:260, log())
[2021-04-05 11:02:32]    INFO >> epoch 009:   6732 / 7096 loss=1.566, accuracy=0, mrr=0, ppl=2.96, wps=42250.2, ups=3.36, wpb=12585.4, bsz=128, num_updates=63500, lr=0.001, gnorm=0.244, clip=0, train_wall=148, wall=19644 (progress_bar.py:260, log())
[2021-04-05 11:04:20]    INFO >> epoch 009 | loss 1.55 | accuracy 0 | mrr 0 | ppl 2.93 | wps 40559.7 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 63864 | lr 0.001 | gnorm 0.239 | clip 0 | train_wall 2091 | wall 19753 (progress_bar.py:269, print())
[2021-04-05 11:05:31]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.886 | accuracy 0.702527 | mrr 0.78956 | ppl 3.7 | wps 66540 | wpb 24841.4 | bsz 255.4 | num_updates 63864 | best_mrr 0.78956 (progress_bar.py:269, print())
[2021-04-05 11:05:51]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 9 @ 63864 updates, score 0.78956) (writing took 19.126548 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 11:06:37]    INFO >> epoch 010:    136 / 7096 loss=1.548, accuracy=0, mrr=0, ppl=2.92, wps=25681.4, ups=2.04, wpb=12589.8, bsz=127.9, num_updates=64000, lr=0.001, gnorm=0.24, clip=0, train_wall=147, wall=19890 (progress_bar.py:260, log())
[2021-04-05 11:09:07]    INFO >> epoch 010:    636 / 7096 loss=1.499, accuracy=0, mrr=0, ppl=2.83, wps=42090.8, ups=3.34, wpb=12594.5, bsz=128, num_updates=64500, lr=0.001, gnorm=0.243, clip=0, train_wall=149, wall=20039 (progress_bar.py:260, log())
[2021-04-05 11:11:35]    INFO >> epoch 010:   1136 / 7096 loss=1.51, accuracy=0, mrr=0, ppl=2.85, wps=42541.1, ups=3.37, wpb=12611.7, bsz=128, num_updates=65000, lr=0.001, gnorm=0.248, clip=0, train_wall=147, wall=20187 (progress_bar.py:260, log())
[2021-04-05 11:14:02]    INFO >> epoch 010:   1636 / 7096 loss=1.517, accuracy=0, mrr=0, ppl=2.86, wps=42877.6, ups=3.4, wpb=12610.9, bsz=128, num_updates=65500, lr=0.001, gnorm=0.246, clip=0, train_wall=146, wall=20335 (progress_bar.py:260, log())
[2021-04-05 11:16:29]    INFO >> epoch 010:   2136 / 7096 loss=1.522, accuracy=0, mrr=0, ppl=2.87, wps=42893.9, ups=3.41, wpb=12592.5, bsz=128, num_updates=66000, lr=0.001, gnorm=0.247, clip=0, train_wall=146, wall=20481 (progress_bar.py:260, log())
[2021-04-05 11:18:57]    INFO >> epoch 010:   2636 / 7096 loss=1.527, accuracy=0, mrr=0, ppl=2.88, wps=42503.1, ups=3.37, wpb=12618.9, bsz=128, num_updates=66500, lr=0.001, gnorm=0.243, clip=0, train_wall=147, wall=20630 (progress_bar.py:260, log())
[2021-04-05 11:21:25]    INFO >> epoch 010:   3136 / 7096 loss=1.534, accuracy=0, mrr=0, ppl=2.9, wps=42738, ups=3.39, wpb=12601.3, bsz=128, num_updates=67000, lr=0.001, gnorm=0.248, clip=0, train_wall=146, wall=20777 (progress_bar.py:260, log())
[2021-04-05 11:23:53]    INFO >> epoch 010:   3636 / 7096 loss=1.532, accuracy=0, mrr=0, ppl=2.89, wps=42592.2, ups=3.38, wpb=12611.4, bsz=128, num_updates=67500, lr=0.001, gnorm=0.245, clip=0, train_wall=147, wall=20925 (progress_bar.py:260, log())
[2021-04-05 11:26:20]    INFO >> epoch 010:   4136 / 7096 loss=1.534, accuracy=0, mrr=0, ppl=2.9, wps=42631.4, ups=3.39, wpb=12582.4, bsz=128, num_updates=68000, lr=0.001, gnorm=0.243, clip=0, train_wall=147, wall=21073 (progress_bar.py:260, log())
[2021-04-05 11:28:47]    INFO >> epoch 010:   4636 / 7096 loss=1.539, accuracy=0, mrr=0, ppl=2.91, wps=42855.4, ups=3.41, wpb=12575.8, bsz=128, num_updates=68500, lr=0.001, gnorm=0.248, clip=0, train_wall=146, wall=21220 (progress_bar.py:260, log())
[2021-04-05 11:31:15]    INFO >> epoch 010:   5136 / 7096 loss=1.544, accuracy=0, mrr=0, ppl=2.92, wps=42691.2, ups=3.39, wpb=12595.5, bsz=128, num_updates=69000, lr=0.001, gnorm=0.249, clip=0, train_wall=146, wall=21367 (progress_bar.py:260, log())
[2021-04-05 11:33:42]    INFO >> epoch 010:   5636 / 7096 loss=1.548, accuracy=0, mrr=0, ppl=2.92, wps=42509.4, ups=3.39, wpb=12548, bsz=128, num_updates=69500, lr=0.001, gnorm=0.247, clip=0, train_wall=146, wall=21515 (progress_bar.py:260, log())
[2021-04-05 11:36:10]    INFO >> epoch 010:   6136 / 7096 loss=1.545, accuracy=0, mrr=0, ppl=2.92, wps=42636, ups=3.38, wpb=12598.4, bsz=128, num_updates=70000, lr=0.001, gnorm=0.245, clip=0, train_wall=147, wall=21662 (progress_bar.py:260, log())
[2021-04-05 11:38:41]    INFO >> epoch 010:   6636 / 7096 loss=1.55, accuracy=0, mrr=0, ppl=2.93, wps=41971.9, ups=3.31, wpb=12668.1, bsz=128, num_updates=70500, lr=0.001, gnorm=0.246, clip=0, train_wall=150, wall=21813 (progress_bar.py:260, log())
[2021-04-05 11:40:57]    INFO >> epoch 010 | loss 1.532 | accuracy 0 | mrr 0 | ppl 2.89 | wps 40684.6 | ups 3.23 | wpb 12597.3 | bsz 128 | num_updates 70960 | lr 0.001 | gnorm 0.246 | clip 0 | train_wall 2085 | wall 21950 (progress_bar.py:269, print())
[2021-04-05 11:42:09]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.89 | accuracy 0.702126 | mrr 0.789168 | ppl 3.71 | wps 66396.7 | wpb 24841.4 | bsz 255.4 | num_updates 70960 | best_mrr 0.78956 (progress_bar.py:269, print())
[2021-04-05 11:42:21]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 10 @ 70960 updates, score 0.789168) (writing took 12.632946 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 11:42:39]    INFO >> epoch 011:     40 / 7096 loss=1.546, accuracy=0, mrr=0, ppl=2.92, wps=26377.5, ups=2.1, wpb=12575.5, bsz=127.9, num_updates=71000, lr=0.001, gnorm=0.247, clip=0, train_wall=147, wall=22052 (progress_bar.py:260, log())
[2021-04-05 11:45:07]    INFO >> epoch 011:    540 / 7096 loss=1.475, accuracy=0, mrr=0, ppl=2.78, wps=42723.7, ups=3.39, wpb=12596, bsz=128, num_updates=71500, lr=0.001, gnorm=0.251, clip=0, train_wall=146, wall=22199 (progress_bar.py:260, log())
[2021-04-05 11:47:35]    INFO >> epoch 011:   1040 / 7096 loss=1.492, accuracy=0, mrr=0, ppl=2.81, wps=42452.8, ups=3.38, wpb=12558.4, bsz=128, num_updates=72000, lr=0.001, gnorm=0.257, clip=0, train_wall=147, wall=22347 (progress_bar.py:260, log())
[2021-04-05 11:50:02]    INFO >> epoch 011:   1540 / 7096 loss=1.498, accuracy=0, mrr=0, ppl=2.82, wps=42623.3, ups=3.38, wpb=12593.5, bsz=128, num_updates=72500, lr=0.001, gnorm=0.258, clip=0, train_wall=147, wall=22495 (progress_bar.py:260, log())
[2021-04-05 11:52:31]    INFO >> epoch 011:   2040 / 7096 loss=1.503, accuracy=0, mrr=0, ppl=2.83, wps=42354.1, ups=3.37, wpb=12569, bsz=128, num_updates=73000, lr=0.001, gnorm=0.25, clip=0, train_wall=147, wall=22643 (progress_bar.py:260, log())
[2021-04-05 11:55:01]    INFO >> epoch 011:   2540 / 7096 loss=1.507, accuracy=0, mrr=0, ppl=2.84, wps=42077.4, ups=3.33, wpb=12628.5, bsz=128, num_updates=73500, lr=0.001, gnorm=0.252, clip=0, train_wall=149, wall=22793 (progress_bar.py:260, log())
[2021-04-05 11:57:28]    INFO >> epoch 011:   3040 / 7096 loss=1.517, accuracy=0, mrr=0, ppl=2.86, wps=42951.6, ups=3.39, wpb=12656.9, bsz=128, num_updates=74000, lr=0.001, gnorm=0.255, clip=0, train_wall=146, wall=22940 (progress_bar.py:260, log())
[2021-04-05 11:59:57]    INFO >> epoch 011:   3540 / 7096 loss=1.518, accuracy=0, mrr=0, ppl=2.86, wps=42099.2, ups=3.35, wpb=12552.5, bsz=128, num_updates=74500, lr=0.001, gnorm=0.256, clip=0, train_wall=148, wall=23090 (progress_bar.py:260, log())
[2021-04-05 12:02:27]    INFO >> epoch 011:   4040 / 7096 loss=1.519, accuracy=0, mrr=0, ppl=2.87, wps=42079.3, ups=3.34, wpb=12591.3, bsz=128, num_updates=75000, lr=0.001, gnorm=0.256, clip=0, train_wall=149, wall=23239 (progress_bar.py:260, log())
[2021-04-05 12:04:55]    INFO >> epoch 011:   4540 / 7096 loss=1.523, accuracy=0, mrr=0, ppl=2.87, wps=42328.4, ups=3.37, wpb=12569.2, bsz=128, num_updates=75500, lr=0.001, gnorm=0.254, clip=0, train_wall=147, wall=23388 (progress_bar.py:260, log())
[2021-04-05 12:07:27]    INFO >> epoch 011:   5040 / 7096 loss=1.526, accuracy=0, mrr=0, ppl=2.88, wps=41674.2, ups=3.29, wpb=12676.3, bsz=128, num_updates=76000, lr=0.001, gnorm=0.256, clip=0, train_wall=151, wall=23540 (progress_bar.py:260, log())
[2021-04-05 12:09:56]    INFO >> epoch 011:   5540 / 7096 loss=1.53, accuracy=0, mrr=0, ppl=2.89, wps=42118.2, ups=3.35, wpb=12558.2, bsz=128, num_updates=76500, lr=0.001, gnorm=0.254, clip=0, train_wall=148, wall=23689 (progress_bar.py:260, log())
[2021-04-05 12:12:24]    INFO >> epoch 011:   6040 / 7096 loss=1.533, accuracy=0, mrr=0, ppl=2.89, wps=42612.9, ups=3.39, wpb=12576.5, bsz=128, num_updates=77000, lr=0.001, gnorm=0.252, clip=0, train_wall=146, wall=23836 (progress_bar.py:260, log())
[2021-04-05 12:14:52]    INFO >> epoch 011:   6540 / 7096 loss=1.535, accuracy=0, mrr=0, ppl=2.9, wps=42399.8, ups=3.37, wpb=12594.9, bsz=128, num_updates=77500, lr=0.001, gnorm=0.254, clip=0, train_wall=147, wall=23985 (progress_bar.py:260, log())
[2021-04-05 12:17:21]    INFO >> epoch 011:   7040 / 7096 loss=1.537, accuracy=0, mrr=0, ppl=2.9, wps=42530, ups=3.36, wpb=12654.8, bsz=128, num_updates=78000, lr=0.001, gnorm=0.259, clip=0, train_wall=148, wall=24134 (progress_bar.py:260, log())
[2021-04-05 12:17:38]    INFO >> epoch 011 | loss 1.515 | accuracy 0 | mrr 0 | ppl 2.86 | wps 40613.7 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 78056 | lr 0.001 | gnorm 0.255 | clip 0 | train_wall 2095 | wall 24151 (progress_bar.py:269, print())
[2021-04-05 12:18:50]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.886 | accuracy 0.702508 | mrr 0.789443 | ppl 3.7 | wps 66688.2 | wpb 24841.4 | bsz 255.4 | num_updates 78056 | best_mrr 0.78956 (progress_bar.py:269, print())
[2021-04-05 12:19:02]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 11 @ 78056 updates, score 0.789443) (writing took 12.483871 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 12:21:20]    INFO >> epoch 012:    444 / 7096 loss=1.467, accuracy=0, mrr=0, ppl=2.77, wps=26282.6, ups=2.1, wpb=12537.8, bsz=127.9, num_updates=78500, lr=0.001, gnorm=0.257, clip=0, train_wall=147, wall=24372 (progress_bar.py:260, log())
[2021-04-05 12:23:47]    INFO >> epoch 012:    944 / 7096 loss=1.472, accuracy=0, mrr=0, ppl=2.77, wps=42773.8, ups=3.4, wpb=12586, bsz=128, num_updates=79000, lr=0.001, gnorm=0.263, clip=0, train_wall=146, wall=24519 (progress_bar.py:260, log())
[2021-04-05 12:26:16]    INFO >> epoch 012:   1444 / 7096 loss=1.482, accuracy=0, mrr=0, ppl=2.79, wps=42369.4, ups=3.35, wpb=12639, bsz=128, num_updates=79500, lr=0.001, gnorm=0.258, clip=0, train_wall=148, wall=24669 (progress_bar.py:260, log())
[2021-04-05 12:28:44]    INFO >> epoch 012:   1944 / 7096 loss=1.491, accuracy=0, mrr=0, ppl=2.81, wps=42463.4, ups=3.37, wpb=12604.7, bsz=128, num_updates=80000, lr=0.001, gnorm=0.259, clip=0, train_wall=147, wall=24817 (progress_bar.py:260, log())
[2021-04-05 12:31:14]    INFO >> epoch 012:   2444 / 7096 loss=1.495, accuracy=0, mrr=0, ppl=2.82, wps=42087.9, ups=3.35, wpb=12576.4, bsz=128, num_updates=80500, lr=0.001, gnorm=0.26, clip=0, train_wall=148, wall=24966 (progress_bar.py:260, log())
[2021-04-05 12:33:42]    INFO >> epoch 012:   2944 / 7096 loss=1.498, accuracy=0, mrr=0, ppl=2.83, wps=42414.8, ups=3.37, wpb=12594.3, bsz=128, num_updates=81000, lr=0.001, gnorm=0.266, clip=0, train_wall=147, wall=25115 (progress_bar.py:260, log())
[2021-04-05 12:36:12]    INFO >> epoch 012:   3444 / 7096 loss=1.503, accuracy=0, mrr=0, ppl=2.83, wps=42164.5, ups=3.34, wpb=12606.7, bsz=128, num_updates=81500, lr=0.001, gnorm=0.262, clip=0, train_wall=148, wall=25264 (progress_bar.py:260, log())
[2021-04-05 12:38:39]    INFO >> epoch 012:   3944 / 7096 loss=1.506, accuracy=0, mrr=0, ppl=2.84, wps=42689.2, ups=3.4, wpb=12553.4, bsz=128, num_updates=82000, lr=0.001, gnorm=0.259, clip=0, train_wall=146, wall=25411 (progress_bar.py:260, log())
[2021-04-05 12:41:06]    INFO >> epoch 012:   4444 / 7096 loss=1.51, accuracy=0, mrr=0, ppl=2.85, wps=42650.2, ups=3.4, wpb=12557, bsz=128, num_updates=82500, lr=0.001, gnorm=0.26, clip=0, train_wall=146, wall=25559 (progress_bar.py:260, log())
[2021-04-05 12:43:36]    INFO >> epoch 012:   4944 / 7096 loss=1.508, accuracy=0, mrr=0, ppl=2.85, wps=42049.8, ups=3.33, wpb=12622.7, bsz=128, num_updates=83000, lr=0.001, gnorm=0.264, clip=0, train_wall=149, wall=25709 (progress_bar.py:260, log())
[2021-04-05 12:46:05]    INFO >> epoch 012:   5444 / 7096 loss=1.512, accuracy=0, mrr=0, ppl=2.85, wps=42279.8, ups=3.35, wpb=12614, bsz=128, num_updates=83500, lr=0.001, gnorm=0.264, clip=0, train_wall=148, wall=25858 (progress_bar.py:260, log())
[2021-04-05 12:48:35]    INFO >> epoch 012:   5944 / 7096 loss=1.517, accuracy=0, mrr=0, ppl=2.86, wps=42331.6, ups=3.34, wpb=12680.6, bsz=128, num_updates=84000, lr=0.001, gnorm=0.268, clip=0, train_wall=149, wall=26008 (progress_bar.py:260, log())
[2021-04-05 12:51:05]    INFO >> epoch 012:   6444 / 7096 loss=1.519, accuracy=0, mrr=0, ppl=2.87, wps=42012.7, ups=3.34, wpb=12574.1, bsz=128, num_updates=84500, lr=0.001, gnorm=0.263, clip=0, train_wall=149, wall=26157 (progress_bar.py:260, log())
[2021-04-05 12:53:34]    INFO >> epoch 012:   6944 / 7096 loss=1.524, accuracy=0, mrr=0, ppl=2.88, wps=42212.8, ups=3.35, wpb=12586.7, bsz=128, num_updates=85000, lr=0.001, gnorm=0.259, clip=0, train_wall=148, wall=26306 (progress_bar.py:260, log())
[2021-04-05 12:54:20]    INFO >> epoch 012 | loss 1.501 | accuracy 0 | mrr 0 | ppl 2.83 | wps 40603 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 85152 | lr 0.001 | gnorm 0.262 | clip 0 | train_wall 2096 | wall 26353 (progress_bar.py:269, print())
[2021-04-05 12:55:31]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.891 | accuracy 0.703019 | mrr 0.789784 | ppl 3.71 | wps 66655.6 | wpb 24841.4 | bsz 255.4 | num_updates 85152 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 12:55:51]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_best.pt (epoch 12 @ 85152 updates, score 0.789784) (writing took 19.488594 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 12:57:39]    INFO >> epoch 013:    348 / 7096 loss=1.473, accuracy=0, mrr=0, ppl=2.78, wps=25816.4, ups=2.04, wpb=12635.4, bsz=127.9, num_updates=85500, lr=0.001, gnorm=0.267, clip=0, train_wall=146, wall=26551 (progress_bar.py:260, log())
[2021-04-05 13:00:07]    INFO >> epoch 013:    848 / 7096 loss=1.458, accuracy=0, mrr=0, ppl=2.75, wps=42145.6, ups=3.36, wpb=12551.8, bsz=128, num_updates=86000, lr=0.001, gnorm=0.266, clip=0, train_wall=148, wall=26700 (progress_bar.py:260, log())
[2021-04-05 13:02:35]    INFO >> epoch 013:   1348 / 7096 loss=1.466, accuracy=0, mrr=0, ppl=2.76, wps=42626.8, ups=3.38, wpb=12618.8, bsz=128, num_updates=86500, lr=0.001, gnorm=0.265, clip=0, train_wall=147, wall=26848 (progress_bar.py:260, log())
[2021-04-05 13:05:02]    INFO >> epoch 013:   1848 / 7096 loss=1.473, accuracy=0, mrr=0, ppl=2.78, wps=42875.6, ups=3.41, wpb=12564.2, bsz=128, num_updates=87000, lr=0.001, gnorm=0.269, clip=0, train_wall=145, wall=26994 (progress_bar.py:260, log())
[2021-04-05 13:07:31]    INFO >> epoch 013:   2348 / 7096 loss=1.481, accuracy=0, mrr=0, ppl=2.79, wps=42171.7, ups=3.35, wpb=12585.8, bsz=128, num_updates=87500, lr=0.001, gnorm=0.266, clip=0, train_wall=148, wall=27144 (progress_bar.py:260, log())
[2021-04-05 13:10:00]    INFO >> epoch 013:   2848 / 7096 loss=1.481, accuracy=0, mrr=0, ppl=2.79, wps=42310, ups=3.35, wpb=12611.7, bsz=128, num_updates=88000, lr=0.001, gnorm=0.272, clip=0, train_wall=148, wall=27293 (progress_bar.py:260, log())
[2021-04-05 13:12:28]    INFO >> epoch 013:   3348 / 7096 loss=1.49, accuracy=0, mrr=0, ppl=2.81, wps=42511.2, ups=3.38, wpb=12583.3, bsz=128, num_updates=88500, lr=0.001, gnorm=0.268, clip=0, train_wall=147, wall=27441 (progress_bar.py:260, log())
[2021-04-05 13:14:55]    INFO >> epoch 013:   3848 / 7096 loss=1.494, accuracy=0, mrr=0, ppl=2.82, wps=42799.9, ups=3.4, wpb=12586.7, bsz=128, num_updates=89000, lr=0.001, gnorm=0.269, clip=0, train_wall=146, wall=27588 (progress_bar.py:260, log())
[2021-04-05 13:17:26]    INFO >> epoch 013:   4348 / 7096 loss=1.495, accuracy=0, mrr=0, ppl=2.82, wps=42054.4, ups=3.33, wpb=12641.6, bsz=128, num_updates=89500, lr=0.001, gnorm=0.268, clip=0, train_wall=149, wall=27738 (progress_bar.py:260, log())
[2021-04-05 13:19:54]    INFO >> epoch 013:   4848 / 7096 loss=1.497, accuracy=0, mrr=0, ppl=2.82, wps=42405.5, ups=3.37, wpb=12593.2, bsz=128, num_updates=90000, lr=0.001, gnorm=0.27, clip=0, train_wall=147, wall=27887 (progress_bar.py:260, log())
[2021-04-05 13:22:24]    INFO >> epoch 013:   5348 / 7096 loss=1.5, accuracy=0, mrr=0, ppl=2.83, wps=42381.9, ups=3.34, wpb=12682.2, bsz=128, num_updates=90500, lr=0.001, gnorm=0.266, clip=0, train_wall=149, wall=28036 (progress_bar.py:260, log())
[2021-04-05 13:24:53]    INFO >> epoch 013:   5848 / 7096 loss=1.502, accuracy=0, mrr=0, ppl=2.83, wps=42327.2, ups=3.36, wpb=12601.5, bsz=128, num_updates=91000, lr=0.001, gnorm=0.271, clip=0, train_wall=148, wall=28185 (progress_bar.py:260, log())
[2021-04-05 13:27:22]    INFO >> epoch 013:   6348 / 7096 loss=1.502, accuracy=0, mrr=0, ppl=2.83, wps=42069, ups=3.34, wpb=12576.9, bsz=128, num_updates=91500, lr=0.001, gnorm=0.274, clip=0, train_wall=148, wall=28335 (progress_bar.py:260, log())
[2021-04-05 13:29:51]    INFO >> epoch 013:   6848 / 7096 loss=1.509, accuracy=0, mrr=0, ppl=2.85, wps=42281.6, ups=3.37, wpb=12559.1, bsz=128, num_updates=92000, lr=0.001, gnorm=0.264, clip=0, train_wall=147, wall=28483 (progress_bar.py:260, log())
[2021-04-05 13:31:05]    INFO >> epoch 013 | loss 1.487 | accuracy 0 | mrr 0 | ppl 2.8 | wps 40541.6 | ups 3.22 | wpb 12597.3 | bsz 128 | num_updates 92248 | lr 0.001 | gnorm 0.268 | clip 0 | train_wall 2092 | wall 28557 (progress_bar.py:269, print())
[2021-04-05 13:32:16]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.9 | accuracy 0.703044 | mrr 0.789758 | ppl 3.73 | wps 66614.5 | wpb 24841.4 | bsz 255.4 | num_updates 92248 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 13:32:29]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 13 @ 92248 updates, score 0.789758) (writing took 12.707565 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 13:33:50]    INFO >> epoch 014:    252 / 7096 loss=1.474, accuracy=0, mrr=0, ppl=2.78, wps=26290.8, ups=2.09, wpb=12599.2, bsz=127.9, num_updates=92500, lr=0.001, gnorm=0.271, clip=0, train_wall=148, wall=28723 (progress_bar.py:260, log())
[2021-04-05 13:36:20]    INFO >> epoch 014:    752 / 7096 loss=1.441, accuracy=0, mrr=0, ppl=2.72, wps=42263.3, ups=3.35, wpb=12629.6, bsz=128, num_updates=93000, lr=0.001, gnorm=0.272, clip=0, train_wall=148, wall=28872 (progress_bar.py:260, log())
[2021-04-05 13:38:49]    INFO >> epoch 014:   1252 / 7096 loss=1.453, accuracy=0, mrr=0, ppl=2.74, wps=42373.3, ups=3.35, wpb=12630.5, bsz=128, num_updates=93500, lr=0.001, gnorm=0.278, clip=0, train_wall=148, wall=29021 (progress_bar.py:260, log())
[2021-04-05 13:41:18]    INFO >> epoch 014:   1752 / 7096 loss=1.46, accuracy=0, mrr=0, ppl=2.75, wps=41818.4, ups=3.34, wpb=12528.5, bsz=128, num_updates=94000, lr=0.001, gnorm=0.274, clip=0, train_wall=149, wall=29171 (progress_bar.py:260, log())
[2021-04-05 13:43:47]    INFO >> epoch 014:   2252 / 7096 loss=1.465, accuracy=0, mrr=0, ppl=2.76, wps=42399.2, ups=3.37, wpb=12586.2, bsz=128, num_updates=94500, lr=0.001, gnorm=0.273, clip=0, train_wall=147, wall=29319 (progress_bar.py:260, log())
[2021-04-05 13:46:17]    INFO >> epoch 014:   2752 / 7096 loss=1.472, accuracy=0, mrr=0, ppl=2.77, wps=41846.1, ups=3.34, wpb=12532.8, bsz=128, num_updates=95000, lr=0.001, gnorm=0.277, clip=0, train_wall=149, wall=29469 (progress_bar.py:260, log())
[2021-04-05 13:48:46]    INFO >> epoch 014:   3252 / 7096 loss=1.472, accuracy=0, mrr=0, ppl=2.77, wps=42124.8, ups=3.35, wpb=12570.8, bsz=128, num_updates=95500, lr=0.001, gnorm=0.272, clip=0, train_wall=148, wall=29618 (progress_bar.py:260, log())
[2021-04-05 13:51:13]    INFO >> epoch 014:   3752 / 7096 loss=1.48, accuracy=0, mrr=0, ppl=2.79, wps=42636.2, ups=3.39, wpb=12585.8, bsz=128, num_updates=96000, lr=0.001, gnorm=0.277, clip=0, train_wall=147, wall=29766 (progress_bar.py:260, log())
[2021-04-05 13:53:43]    INFO >> epoch 014:   4252 / 7096 loss=1.485, accuracy=0, mrr=0, ppl=2.8, wps=42261.4, ups=3.34, wpb=12646.4, bsz=128, num_updates=96500, lr=0.001, gnorm=0.274, clip=0, train_wall=149, wall=29916 (progress_bar.py:260, log())
[2021-04-05 13:56:11]    INFO >> epoch 014:   4752 / 7096 loss=1.49, accuracy=0, mrr=0, ppl=2.81, wps=42396.8, ups=3.38, wpb=12530.8, bsz=128, num_updates=97000, lr=0.001, gnorm=0.276, clip=0, train_wall=147, wall=30063 (progress_bar.py:260, log())
[2021-04-05 13:58:38]    INFO >> epoch 014:   5252 / 7096 loss=1.488, accuracy=0, mrr=0, ppl=2.81, wps=42644.3, ups=3.39, wpb=12591.2, bsz=128, num_updates=97500, lr=0.001, gnorm=0.278, clip=0, train_wall=147, wall=30211 (progress_bar.py:260, log())
[2021-04-05 14:01:06]    INFO >> epoch 014:   5752 / 7096 loss=1.494, accuracy=0, mrr=0, ppl=2.82, wps=42782.9, ups=3.39, wpb=12606.8, bsz=128, num_updates=98000, lr=0.001, gnorm=0.268, clip=0, train_wall=146, wall=30358 (progress_bar.py:260, log())
[2021-04-05 14:03:34]    INFO >> epoch 014:   6252 / 7096 loss=1.488, accuracy=0, mrr=0, ppl=2.81, wps=42397.1, ups=3.38, wpb=12556.3, bsz=128, num_updates=98500, lr=0.001, gnorm=0.276, clip=0, train_wall=147, wall=30506 (progress_bar.py:260, log())
[2021-04-05 14:06:02]    INFO >> epoch 014:   6752 / 7096 loss=1.493, accuracy=0, mrr=0, ppl=2.81, wps=42785.6, ups=3.37, wpb=12680, bsz=128, num_updates=99000, lr=0.001, gnorm=0.274, clip=0, train_wall=147, wall=30655 (progress_bar.py:260, log())
[2021-04-05 14:07:45]    INFO >> epoch 014 | loss 1.475 | accuracy 0 | mrr 0 | ppl 2.78 | wps 40631.6 | ups 3.23 | wpb 12597.3 | bsz 128 | num_updates 99344 | lr 0.001 | gnorm 0.274 | clip 0 | train_wall 2094 | wall 30757 (progress_bar.py:269, print())
[2021-04-05 14:08:56]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.903 | accuracy 0.702633 | mrr 0.789424 | ppl 3.74 | wps 66720.9 | wpb 24841.4 | bsz 255.4 | num_updates 99344 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 14:09:09]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 14 @ 99344 updates, score 0.789424) (writing took 12.584951 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 14:10:01]    INFO >> epoch 015:    156 / 7096 loss=1.472, accuracy=0, mrr=0, ppl=2.77, wps=26432.3, ups=2.09, wpb=12643.7, bsz=127.9, num_updates=99500, lr=0.001, gnorm=0.274, clip=0, train_wall=148, wall=30894 (progress_bar.py:260, log())
[2021-04-05 14:12:30]    INFO >> epoch 015:    656 / 7096 loss=1.432, accuracy=0, mrr=0, ppl=2.7, wps=42296, ups=3.36, wpb=12599.2, bsz=128, num_updates=100000, lr=0.001, gnorm=0.284, clip=0, train_wall=148, wall=31043 (progress_bar.py:260, log())
[2021-04-05 14:14:59]    INFO >> epoch 015:   1156 / 7096 loss=1.437, accuracy=0, mrr=0, ppl=2.71, wps=42416.4, ups=3.36, wpb=12633.9, bsz=128, num_updates=100500, lr=0.001, gnorm=0.281, clip=0, train_wall=148, wall=31192 (progress_bar.py:260, log())
[2021-04-05 14:17:28]    INFO >> epoch 015:   1656 / 7096 loss=1.445, accuracy=0, mrr=0, ppl=2.72, wps=42230.8, ups=3.37, wpb=12537.1, bsz=128, num_updates=101000, lr=0.001, gnorm=0.284, clip=0, train_wall=147, wall=31340 (progress_bar.py:260, log())
[2021-04-05 14:19:57]    INFO >> epoch 015:   2156 / 7096 loss=1.455, accuracy=0, mrr=0, ppl=2.74, wps=42263.2, ups=3.35, wpb=12602.7, bsz=128, num_updates=101500, lr=0.001, gnorm=0.279, clip=0, train_wall=148, wall=31489 (progress_bar.py:260, log())
[2021-04-05 14:22:25]    INFO >> epoch 015:   2656 / 7096 loss=1.459, accuracy=0, mrr=0, ppl=2.75, wps=42553.9, ups=3.37, wpb=12625.9, bsz=128, num_updates=102000, lr=0.001, gnorm=0.279, clip=0, train_wall=147, wall=31637 (progress_bar.py:260, log())
[2021-04-05 14:24:54]    INFO >> epoch 015:   3156 / 7096 loss=1.463, accuracy=0, mrr=0, ppl=2.76, wps=42104.1, ups=3.35, wpb=12568.7, bsz=128, num_updates=102500, lr=0.001, gnorm=0.279, clip=0, train_wall=148, wall=31787 (progress_bar.py:260, log())
[2021-04-05 14:27:24]    INFO >> epoch 015:   3656 / 7096 loss=1.47, accuracy=0, mrr=0, ppl=2.77, wps=41834.5, ups=3.34, wpb=12541.4, bsz=128, num_updates=103000, lr=0.001, gnorm=0.282, clip=0, train_wall=149, wall=31937 (progress_bar.py:260, log())
[2021-04-05 14:29:52]    INFO >> epoch 015:   4156 / 7096 loss=1.47, accuracy=0, mrr=0, ppl=2.77, wps=42868.9, ups=3.39, wpb=12637.2, bsz=128, num_updates=103500, lr=0.001, gnorm=0.278, clip=0, train_wall=146, wall=32084 (progress_bar.py:260, log())
[2021-04-05 14:32:20]    INFO >> epoch 015:   4656 / 7096 loss=1.473, accuracy=0, mrr=0, ppl=2.78, wps=42539.1, ups=3.37, wpb=12626.2, bsz=128, num_updates=104000, lr=0.001, gnorm=0.288, clip=0, train_wall=147, wall=32232 (progress_bar.py:260, log())
[2021-04-05 14:34:48]    INFO >> epoch 015:   5156 / 7096 loss=1.48, accuracy=0, mrr=0, ppl=2.79, wps=42737, ups=3.39, wpb=12622.7, bsz=128, num_updates=104500, lr=0.001, gnorm=0.283, clip=0, train_wall=147, wall=32380 (progress_bar.py:260, log())
[2021-04-05 14:37:16]    INFO >> epoch 015:   5656 / 7096 loss=1.478, accuracy=0, mrr=0, ppl=2.79, wps=42560.1, ups=3.36, wpb=12650, bsz=128, num_updates=105000, lr=0.001, gnorm=0.284, clip=0, train_wall=148, wall=32529 (progress_bar.py:260, log())
[2021-04-05 14:39:45]    INFO >> epoch 015:   6156 / 7096 loss=1.482, accuracy=0, mrr=0, ppl=2.79, wps=42256.6, ups=3.35, wpb=12614.6, bsz=128, num_updates=105500, lr=0.001, gnorm=0.286, clip=0, train_wall=148, wall=32678 (progress_bar.py:260, log())
[2021-04-05 14:42:13]    INFO >> epoch 015:   6656 / 7096 loss=1.486, accuracy=0, mrr=0, ppl=2.8, wps=42676.3, ups=3.4, wpb=12552.7, bsz=128, num_updates=106000, lr=0.001, gnorm=0.283, clip=0, train_wall=146, wall=32825 (progress_bar.py:260, log())
[2021-04-05 14:44:24]    INFO >> epoch 015 | loss 1.464 | accuracy 0 | mrr 0 | ppl 2.76 | wps 40641 | ups 3.23 | wpb 12597.3 | bsz 128 | num_updates 106440 | lr 0.001 | gnorm 0.282 | clip 0 | train_wall 2094 | wall 32957 (progress_bar.py:269, print())
[2021-04-05 14:45:36]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.904 | accuracy 0.70292 | mrr 0.789577 | ppl 3.74 | wps 66386.6 | wpb 24841.4 | bsz 255.4 | num_updates 106440 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 14:45:48]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 15 @ 106440 updates, score 0.789577) (writing took 12.642365 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 14:46:13]    INFO >> epoch 016:     60 / 7096 loss=1.478, accuracy=0, mrr=0, ppl=2.79, wps=26077.7, ups=2.08, wpb=12563.8, bsz=127.9, num_updates=106500, lr=0.001, gnorm=0.28, clip=0, train_wall=149, wall=33066 (progress_bar.py:260, log())
[2021-04-05 14:48:41]    INFO >> epoch 016:    560 / 7096 loss=1.416, accuracy=0, mrr=0, ppl=2.67, wps=42429.8, ups=3.38, wpb=12546.2, bsz=128, num_updates=107000, lr=0.001, gnorm=0.287, clip=0, train_wall=147, wall=33214 (progress_bar.py:260, log())
[2021-04-05 14:51:09]    INFO >> epoch 016:   1060 / 7096 loss=1.425, accuracy=0, mrr=0, ppl=2.69, wps=42608.8, ups=3.38, wpb=12587.9, bsz=128, num_updates=107500, lr=0.001, gnorm=0.293, clip=0, train_wall=147, wall=33361 (progress_bar.py:260, log())
[2021-04-05 14:53:39]    INFO >> epoch 016:   1560 / 7096 loss=1.438, accuracy=0, mrr=0, ppl=2.71, wps=42075.4, ups=3.33, wpb=12618.2, bsz=128, num_updates=108000, lr=0.001, gnorm=0.29, clip=0, train_wall=149, wall=33511 (progress_bar.py:260, log())
[2021-04-05 14:56:07]    INFO >> epoch 016:   2060 / 7096 loss=1.436, accuracy=0, mrr=0, ppl=2.71, wps=42607.4, ups=3.37, wpb=12650.9, bsz=128, num_updates=108500, lr=0.001, gnorm=0.291, clip=0, train_wall=147, wall=33660 (progress_bar.py:260, log())
[2021-04-05 14:58:34]    INFO >> epoch 016:   2560 / 7096 loss=1.445, accuracy=0, mrr=0, ppl=2.72, wps=42981.4, ups=3.4, wpb=12641.7, bsz=128, num_updates=109000, lr=0.001, gnorm=0.288, clip=0, train_wall=146, wall=33807 (progress_bar.py:260, log())
[2021-04-05 15:01:04]    INFO >> epoch 016:   3060 / 7096 loss=1.455, accuracy=0, mrr=0, ppl=2.74, wps=42310, ups=3.35, wpb=12625.6, bsz=128, num_updates=109500, lr=0.001, gnorm=0.287, clip=0, train_wall=148, wall=33956 (progress_bar.py:260, log())
[2021-04-05 15:03:31]    INFO >> epoch 016:   3560 / 7096 loss=1.461, accuracy=0, mrr=0, ppl=2.75, wps=42470.8, ups=3.38, wpb=12553.2, bsz=128, num_updates=110000, lr=0.001, gnorm=0.292, clip=0, train_wall=147, wall=34104 (progress_bar.py:260, log())
[2021-04-05 15:05:59]    INFO >> epoch 016:   4060 / 7096 loss=1.464, accuracy=0, mrr=0, ppl=2.76, wps=42729.1, ups=3.4, wpb=12567.9, bsz=128, num_updates=110500, lr=0.001, gnorm=0.285, clip=0, train_wall=146, wall=34251 (progress_bar.py:260, log())
[2021-04-05 15:08:28]    INFO >> epoch 016:   4560 / 7096 loss=1.465, accuracy=0, mrr=0, ppl=2.76, wps=42231, ups=3.35, wpb=12609.6, bsz=128, num_updates=111000, lr=0.001, gnorm=0.283, clip=0, train_wall=148, wall=34400 (progress_bar.py:260, log())
[2021-04-05 15:10:56]    INFO >> epoch 016:   5060 / 7096 loss=1.466, accuracy=0, mrr=0, ppl=2.76, wps=42448.1, ups=3.37, wpb=12577.3, bsz=128, num_updates=111500, lr=0.001, gnorm=0.289, clip=0, train_wall=147, wall=34548 (progress_bar.py:260, log())
[2021-04-05 15:13:25]    INFO >> epoch 016:   5560 / 7096 loss=1.466, accuracy=0, mrr=0, ppl=2.76, wps=42111.4, ups=3.35, wpb=12573.5, bsz=128, num_updates=112000, lr=0.001, gnorm=0.292, clip=0, train_wall=148, wall=34698 (progress_bar.py:260, log())
[2021-04-05 15:15:55]    INFO >> epoch 016:   6060 / 7096 loss=1.469, accuracy=0, mrr=0, ppl=2.77, wps=42026.5, ups=3.34, wpb=12599.4, bsz=128, num_updates=112500, lr=0.001, gnorm=0.288, clip=0, train_wall=149, wall=34848 (progress_bar.py:260, log())
[2021-04-05 15:18:24]    INFO >> epoch 016:   6560 / 7096 loss=1.478, accuracy=0, mrr=0, ppl=2.79, wps=42256.2, ups=3.35, wpb=12599.9, bsz=128, num_updates=113000, lr=0.001, gnorm=0.29, clip=0, train_wall=148, wall=34997 (progress_bar.py:260, log())
[2021-04-05 15:20:53]    INFO >> epoch 016:   7060 / 7096 loss=1.478, accuracy=0, mrr=0, ppl=2.79, wps=42571.3, ups=3.37, wpb=12632.1, bsz=128, num_updates=113500, lr=0.001, gnorm=0.29, clip=0, train_wall=147, wall=35145 (progress_bar.py:260, log())
[2021-04-05 15:21:04]    INFO >> epoch 016 | loss 1.454 | accuracy 0 | mrr 0 | ppl 2.74 | wps 40644.7 | ups 3.23 | wpb 12597.3 | bsz 128 | num_updates 113536 | lr 0.001 | gnorm 0.289 | clip 0 | train_wall 2093 | wall 35156 (progress_bar.py:269, print())
[2021-04-05 15:22:15]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.906 | accuracy 0.702759 | mrr 0.789325 | ppl 3.75 | wps 66405 | wpb 24841.4 | bsz 255.4 | num_updates 113536 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 15:22:28]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 16 @ 113536 updates, score 0.789325) (writing took 12.560319 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 15:24:52]    INFO >> epoch 017:    464 / 7096 loss=1.412, accuracy=0, mrr=0, ppl=2.66, wps=26281.9, ups=2.09, wpb=12575.7, bsz=127.9, num_updates=114000, lr=0.001, gnorm=0.3, clip=0, train_wall=148, wall=35384 (progress_bar.py:260, log())
[2021-04-05 15:27:20]    INFO >> epoch 017:    964 / 7096 loss=1.416, accuracy=0, mrr=0, ppl=2.67, wps=42514.6, ups=3.38, wpb=12589.6, bsz=128, num_updates=114500, lr=0.001, gnorm=0.296, clip=0, train_wall=147, wall=35532 (progress_bar.py:260, log())
[2021-04-05 15:29:49]    INFO >> epoch 017:   1464 / 7096 loss=1.424, accuracy=0, mrr=0, ppl=2.68, wps=42412.5, ups=3.35, wpb=12656.5, bsz=128, num_updates=115000, lr=0.001, gnorm=0.301, clip=0, train_wall=148, wall=35682 (progress_bar.py:260, log())
[2021-04-05 15:32:17]    INFO >> epoch 017:   1964 / 7096 loss=1.433, accuracy=0, mrr=0, ppl=2.7, wps=42560.1, ups=3.38, wpb=12582.8, bsz=128, num_updates=115500, lr=0.001, gnorm=0.294, clip=0, train_wall=147, wall=35829 (progress_bar.py:260, log())
[2021-04-05 15:34:46]    INFO >> epoch 017:   2464 / 7096 loss=1.438, accuracy=0, mrr=0, ppl=2.71, wps=42285.2, ups=3.36, wpb=12577.4, bsz=128, num_updates=116000, lr=0.001, gnorm=0.297, clip=0, train_wall=148, wall=35978 (progress_bar.py:260, log())
[2021-04-05 15:37:13]    INFO >> epoch 017:   2964 / 7096 loss=1.44, accuracy=0, mrr=0, ppl=2.71, wps=42655.8, ups=3.39, wpb=12590.4, bsz=128, num_updates=116500, lr=0.001, gnorm=0.295, clip=0, train_wall=147, wall=36126 (progress_bar.py:260, log())
[2021-04-05 15:39:43]    INFO >> epoch 017:   3464 / 7096 loss=1.448, accuracy=0, mrr=0, ppl=2.73, wps=42045.3, ups=3.33, wpb=12612.4, bsz=128, num_updates=117000, lr=0.001, gnorm=0.289, clip=0, train_wall=149, wall=36276 (progress_bar.py:260, log())
[2021-04-05 15:42:12]    INFO >> epoch 017:   3964 / 7096 loss=1.452, accuracy=0, mrr=0, ppl=2.74, wps=42418.8, ups=3.37, wpb=12592.5, bsz=128, num_updates=117500, lr=0.001, gnorm=0.296, clip=0, train_wall=147, wall=36424 (progress_bar.py:260, log())
[2021-04-05 15:44:39]    INFO >> epoch 017:   4464 / 7096 loss=1.456, accuracy=0, mrr=0, ppl=2.74, wps=42608.3, ups=3.4, wpb=12525.2, bsz=128, num_updates=118000, lr=0.001, gnorm=0.298, clip=0, train_wall=146, wall=36571 (progress_bar.py:260, log())
[2021-04-05 15:47:09]    INFO >> epoch 017:   4964 / 7096 loss=1.456, accuracy=0, mrr=0, ppl=2.74, wps=42012.5, ups=3.32, wpb=12662.1, bsz=128, num_updates=118500, lr=0.001, gnorm=0.294, clip=0, train_wall=150, wall=36722 (progress_bar.py:260, log())
[2021-04-05 15:49:39]    INFO >> epoch 017:   5464 / 7096 loss=1.459, accuracy=0, mrr=0, ppl=2.75, wps=42154.7, ups=3.34, wpb=12605.2, bsz=128, num_updates=119000, lr=0.001, gnorm=0.299, clip=0, train_wall=148, wall=36871 (progress_bar.py:260, log())
[2021-04-05 15:52:05]    INFO >> epoch 017:   5964 / 7096 loss=1.461, accuracy=0, mrr=0, ppl=2.75, wps=42920.2, ups=3.41, wpb=12568.7, bsz=128, num_updates=119500, lr=0.001, gnorm=0.296, clip=0, train_wall=145, wall=37018 (progress_bar.py:260, log())
[2021-04-05 15:54:34]    INFO >> epoch 017:   6464 / 7096 loss=1.463, accuracy=0, mrr=0, ppl=2.76, wps=42471, ups=3.37, wpb=12591.7, bsz=128, num_updates=120000, lr=0.001, gnorm=0.296, clip=0, train_wall=147, wall=37166 (progress_bar.py:260, log())
[2021-04-05 15:57:02]    INFO >> epoch 017:   6964 / 7096 loss=1.468, accuracy=0, mrr=0, ppl=2.77, wps=42328.1, ups=3.36, wpb=12597.6, bsz=128, num_updates=120500, lr=0.001, gnorm=0.301, clip=0, train_wall=148, wall=37315 (progress_bar.py:260, log())
[2021-04-05 15:57:43]    INFO >> epoch 017 | loss 1.445 | accuracy 0 | mrr 0 | ppl 2.72 | wps 40653.2 | ups 3.23 | wpb 12597.3 | bsz 128 | num_updates 120632 | lr 0.001 | gnorm 0.296 | clip 0 | train_wall 2093 | wall 37355 (progress_bar.py:269, print())
[2021-04-05 15:58:54]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.913 | accuracy 0.70232 | mrr 0.789016 | ppl 3.77 | wps 66504.1 | wpb 24841.4 | bsz 255.4 | num_updates 120632 | best_mrr 0.789784 (progress_bar.py:269, print())
[2021-04-05 15:59:07]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/all/gpt2/checkpoints/checkpoint_last.pt (epoch 17 @ 120632 updates, score 0.789016) (writing took 12.733964 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-05 15:59:07]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:176, should_stop_early())
[2021-04-05 15:59:07]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:259, single_main())
[2021-04-05 15:59:07]    INFO >> done training in 37435.2 seconds (train.py:271, single_main())
